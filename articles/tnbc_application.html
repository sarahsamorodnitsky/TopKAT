<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Application of TopKAT to a Study of Triple Negative Breast Cancer • TopKAT</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Application of TopKAT to a Study of Triple Negative Breast Cancer">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TopKAT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/TopKAT.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/example_sim_tissue.html">Applying TopKAT to Simulated Tissue Data</a></li>
    <li><a class="dropdown-item" href="../articles/tnbc_application.html">Application of TopKAT to a Study of Triple Negative Breast Cancer</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Application of TopKAT to a Study of Triple Negative Breast Cancer</h1>
            
      

      <div class="d-none name"><code>tnbc_application.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="package-and-data-import">Package and Data Import<a class="anchor" aria-label="anchor" href="#package-and-data-import"></a>
</h2>
<p>This vignette demonstrates the application of TopKAT to a study in
triple negative breast cancer (TNBC) using MIBI-TOF to probe the tumor
microenvironment in breast cancer biopsies. The data was originally
published in <span class="citation">Keren et al. (2018)</span>.</p>
<p>Keren et al. observed that tumor biopsies could be categorized based
on the degree of mixing between immune cells and tumor cells. In some
biopsies, immune and tumor cells colocalized and interspersed together
throughout the tumor. These biopsies were referred to as
<code>mixed" biopsies. In others, immune cells and tumor cells segregated into different regions, forming connected components and loops around each other. These biopsies were called</code>compartmentalized.”
Finally, some biopsies contained very few immune cells altogether and
were referred to as a ``cold” biopsies. The apparent differences in
spatial patterns among immune cells across these biopsies motivated this
as an application of TopKAT, which we illustrate here.</p>
<p>The dataset, <code>tnbc</code> is lazily loaded with the import of
the <code>TopKAT</code> package. We start by importing packages we will
need for our analysis.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sarahsamorodnitsky.github.io/TopKAT/">TopKAT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ACAT</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-gregmisc/gtools" class="external-link">gtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MiRKAT</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rrrlw/TDAstats" class="external-link">TDAstats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load in the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tnbc</span><span class="op">)</span></span></code></pre></div>
<p>We first save perform some basics with the data. We label the cell
types identified in the data, including non-immune cells (tumor cells,
epithelial cells, mesenchymal cells, and endothelial cells) and several
immune cell types, including Tregs, CD4 T cells, CD8 T cells, CD3 T
cells, NK cells, B cells, neutrophils, macrophages, dendritic cells,
DC/monocytes, monocytes/neutrophils, and other unidentified cell types.
We have filtered the dataset already to include just immune and
keratin-positive tumor cells. The documentation for the cell types is
published online alongside the original publication.</p>
<p>We also save the number of biopsies in this dataset,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>38</mn></mrow><annotation encoding="application/x-tex">n=38</annotation></semantics></math>
from 38 different patients.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Label the cell types</span></span>
<span><span class="va">tnbc</span><span class="op">$</span><span class="va">immuneGroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">tnbc</span><span class="op">$</span><span class="va">immuneGroup</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">tnbc</span><span class="op">$</span><span class="va">immuneGroup</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Non-Immune"</span>, <span class="st">"Treg"</span>, <span class="st">"CD4 T"</span>, <span class="st">"CD8 T"</span>, <span class="st">"CD3 T"</span>, <span class="st">"NK"</span>,</span>
<span>                              <span class="st">"B cell"</span>, <span class="st">"Neutrophil"</span>, <span class="st">"Macrophage"</span>, <span class="st">"Dendritic"</span>,</span>
<span>                              <span class="st">"DC/Mono"</span>, <span class="st">"Mono/Neu"</span>, <span class="st">"Other"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename and save the patient IDs</span></span>
<span><span class="va">PIDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">tnbc</span><span class="op">$</span><span class="va">SampleID</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the number of patients</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">PIDs</span><span class="op">)</span></span></code></pre></div>
<p>The biopsy categories (mixed, compartmentalized, cold) are given in
the column <code>tnbc$Class</code> which has three levels, 0, 1, and 2.
The coding is as follows:</p>
<ul>
<li>0 = mixed</li>
<li>1 = compartmentalized</li>
<li>2 = cold</li>
</ul>
<p>Below, we demonstrate several images from the dataset to demonstrate
the different patterns among immune cells and tumor cells. The
classification of the biopsies is given in the figure titles. The
figures illustrate that mixed samples show a scatter of immune and tumor
cells throughout the tumor microenvironment, whereas compartmentalized
samples show distinct clusters of immune cells separate from tumor
cells.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1_ti</span> <span class="op">&lt;-</span> <span class="va">tnbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleID</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span>, begin <span class="op">=</span> <span class="fl">0.35</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune"</span>, <span class="st">"Tumor"</span><span class="op">)</span>,</span>
<span>                             name <span class="op">=</span> <span class="st">"Cell Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Example Image from Patient 1 (Mixed)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2_ti</span> <span class="op">&lt;-</span> <span class="va">tnbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleID</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span>, begin <span class="op">=</span> <span class="fl">0.35</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune"</span>, <span class="st">"Tumor"</span><span class="op">)</span>,</span>
<span>                             name <span class="op">=</span> <span class="st">"Cell Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Example Image from Patient 2 (Mixed)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3_ti</span> <span class="op">&lt;-</span> <span class="va">tnbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleID</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span>, begin <span class="op">=</span> <span class="fl">0.35</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune"</span>, <span class="st">"Tumor"</span><span class="op">)</span>,</span>
<span>                             name <span class="op">=</span> <span class="st">"Cell Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Example Image from Patient 3 (Compartmentalized)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p4_ti</span> <span class="op">&lt;-</span> <span class="va">tnbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleID</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span>, begin <span class="op">=</span> <span class="fl">0.35</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune"</span>, <span class="st">"Tumor"</span><span class="op">)</span>,</span>
<span>                             name <span class="op">=</span> <span class="st">"Cell Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Example Image from Patient 4 (Compartmentalized)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="va">p1_ti</span> <span class="op">+</span> <span class="va">p2_ti</span> <span class="op">+</span></span>
<span>  <span class="va">p3_ti</span> <span class="op">+</span> <span class="va">p4_ti</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/visualizing_some_samples_1.png" alt="plot of chunk visualizing some samples"><div class="figcaption">plot of chunk visualizing some samples</div>
</div>
<p>The goals of this analysis are two-fold. The first goal is to relate
the topological structures among immune cells to overall patient
survival. The second is to describe the distinctions among mixed,
compartmentalized, and cold samples topologically. For both goals, we
focus on capturing the topological structures created by just the immune
cells.</p>
<p>To address both goals, we are going to be applying TopKAT to just the
immune cells. Below, we visualize the same figures above with just the
immune cells shown.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1_i</span> <span class="op">&lt;-</span> <span class="va">tnbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleID</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Group</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span>, begin <span class="op">=</span> <span class="fl">0.35</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune"</span><span class="op">)</span>,</span>
<span>                             name <span class="op">=</span> <span class="st">"Cell Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Example Image from Patient 1 (Mixed)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2_i</span> <span class="op">&lt;-</span> <span class="va">tnbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleID</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Group</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span>, begin <span class="op">=</span> <span class="fl">0.35</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune"</span><span class="op">)</span>,</span>
<span>                             name <span class="op">=</span> <span class="st">"Cell Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Example Image from Patient 2 (Mixed)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3_i</span> <span class="op">&lt;-</span> <span class="va">tnbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleID</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Group</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span>, begin <span class="op">=</span> <span class="fl">0.35</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune"</span><span class="op">)</span>,</span>
<span>                             name <span class="op">=</span> <span class="st">"Cell Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Example Image from Patient 3 (Compartmentalized)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p4_i</span> <span class="op">&lt;-</span> <span class="va">tnbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleID</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Group</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span>, begin <span class="op">=</span> <span class="fl">0.35</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune"</span><span class="op">)</span>,</span>
<span>                             name <span class="op">=</span> <span class="st">"Cell Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Example Image from Patient 4 (Compartmentalized)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1_i</span> <span class="op">+</span> <span class="va">p2_i</span> <span class="op">+</span> </span>
<span>  <span class="va">p3_i</span> <span class="op">+</span> <span class="va">p4_i</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/filtering_to_just_immune_cells_and_visualizing_1.png" alt="plot of chunk filtering to just immune cells and visualizing"><div class="figcaption">plot of chunk filtering to just immune cells and
visualizing</div>
</div>
</div>
<div class="section level2">
<h2 id="applying-topkat">Applying TopKAT<a class="anchor" aria-label="anchor" href="#applying-topkat"></a>
</h2>
<p>The first step in applying TopKAT is to construct a filtration. The
process of filtration creates a series of nested graphs where each cell
is a node and edges are drawn between cells if they are no more than
some distance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϵ</mi><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math>
apart. The goal of applying a filtration is to capture the size (or
``lifespan”) of homologies created among the, in our case, immune cells.
Homologies are the topological structures (connected components and
loops), which we wish to capture.</p>
<p>We first subset the data to just the immune cells (denoted by ``Group
== 2”). We then construct a Rips filtration for each image on the basis
of just the immune cells. The topological structures detected throughout
filtration are summarized in a summary statistic called a persistence
diagram, which are visualized below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save just the immune cells</span></span>
<span><span class="va">tnbc.immune</span> <span class="op">&lt;-</span> <span class="va">tnbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Group</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">tnbc.immune</span><span class="op">$</span><span class="va">immuneGroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">tnbc.immune</span><span class="op">$</span><span class="va">immuneGroup</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a list to store the PDs</span></span>
<span><span class="va">PD.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Iterate through the IDs and generate a Rips complex for the immune cells</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">PIDs</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Print progress</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">PIDs</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">i</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">PIDs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Subset the data to just this PID</span></span>
<span>  <span class="va">data.i</span> <span class="op">&lt;-</span> <span class="va">tnbc.immune</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleID</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Construct a Rips filtration using TDAstats</span></span>
<span>  <span class="va">rips.i</span> <span class="op">&lt;-</span> <span class="fu">TDAstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TDAstats/man/calculate_homology.html" class="external-link">calculate_homology</a></span><span class="op">(</span><span class="va">data.i</span>, dim <span class="op">=</span> <span class="fl">1</span>, threshold <span class="op">=</span> <span class="fl">2048</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Save the results</span></span>
<span>  <span class="va">PD.list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">PIDs</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">i</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">rips.i</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "1/38"</span></span>
<span><span class="co">#&gt; [1] "2/38"</span></span>
<span><span class="co">#&gt; [1] "3/38"</span></span>
<span><span class="co">#&gt; [1] "4/38"</span></span>
<span><span class="co">#&gt; [1] "5/38"</span></span>
<span><span class="co">#&gt; [1] "6/38"</span></span>
<span><span class="co">#&gt; [1] "7/38"</span></span>
<span><span class="co">#&gt; [1] "8/38"</span></span>
<span><span class="co">#&gt; [1] "9/38"</span></span>
<span><span class="co">#&gt; [1] "10/38"</span></span>
<span><span class="co">#&gt; [1] "11/38"</span></span>
<span><span class="co">#&gt; [1] "12/38"</span></span>
<span><span class="co">#&gt; [1] "13/38"</span></span>
<span><span class="co">#&gt; [1] "14/38"</span></span>
<span><span class="co">#&gt; [1] "15/38"</span></span>
<span><span class="co">#&gt; [1] "16/38"</span></span>
<span><span class="co">#&gt; [1] "17/38"</span></span>
<span><span class="co">#&gt; [1] "18/38"</span></span>
<span><span class="co">#&gt; [1] "19/38"</span></span>
<span><span class="co">#&gt; [1] "20/38"</span></span>
<span><span class="co">#&gt; [1] "21/38"</span></span>
<span><span class="co">#&gt; [1] "22/38"</span></span>
<span><span class="co">#&gt; [1] "23/38"</span></span>
<span><span class="co">#&gt; [1] "24/38"</span></span>
<span><span class="co">#&gt; [1] "25/38"</span></span>
<span><span class="co">#&gt; [1] "26/38"</span></span>
<span><span class="co">#&gt; [1] "27/38"</span></span>
<span><span class="co">#&gt; [1] "28/38"</span></span>
<span><span class="co">#&gt; [1] "29/38"</span></span>
<span><span class="co">#&gt; [1] "30/38"</span></span>
<span><span class="co">#&gt; [1] "31/38"</span></span>
<span><span class="co">#&gt; [1] "32/38"</span></span>
<span><span class="co">#&gt; [1] "33/38"</span></span>
<span><span class="co">#&gt; [1] "34/38"</span></span>
<span><span class="co">#&gt; [1] "35/38"</span></span>
<span><span class="co">#&gt; [1] "36/38"</span></span>
<span><span class="co">#&gt; [1] "37/38"</span></span>
<span><span class="co">#&gt; [1] "38/38"</span></span>
<span></span>
<span><span class="co"># Visualize a few examples</span></span>
<span><span class="va">pd1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_persistence.html">plot_persistence</a></span><span class="op">(</span><span class="va">PD.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, title <span class="op">=</span> <span class="st">"Sample 1 (Mixed)"</span>, dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pd2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_persistence.html">plot_persistence</a></span><span class="op">(</span><span class="va">PD.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, title <span class="op">=</span> <span class="st">"Sample 2 (Mixed)"</span>, dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pd3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_persistence.html">plot_persistence</a></span><span class="op">(</span><span class="va">PD.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, title <span class="op">=</span> <span class="st">"Sample 3 \n (Compartmentalized)"</span>, dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pd4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_persistence.html">plot_persistence</a></span><span class="op">(</span><span class="va">PD.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, title <span class="op">=</span> <span class="st">"Sample 4 \n (Compartmentalized)"</span>, dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pd1</span> <span class="op">+</span> <span class="va">pd2</span> <span class="op">+</span> </span>
<span>  <span class="va">pd3</span> <span class="op">+</span> <span class="va">pd4</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/immune_cell_filtration_1.png" alt="plot of immune cell persistence diagrams"><div class="figcaption">plot of immune cell persistence diagrams</div>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"vignettes/figures/immune_cell_filtration_1.png"</span>, error <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="articles/figures/immune_cell_filtration_1.png"><!-- --></p>
<p>After we have calculated a persistence diagram for each image, we
then can associate these persistence diagrams with an outcome. To do
this, we use a kernel machine regression framework. For this, we need to
construct a kernel matrix which quantifies the similarities among pairs
of persistence diagrams. To obtain a kernel matrix, we first start by
calculating a pairwise dissimilarity matrix. The process then is:</p>
<ol style="list-style-type: decimal">
<li>Calculate pairwise dissimilarity matrix between persistence
diagrams</li>
<li>Convert the pairwise dissimilarity matrix to a pairwise kernel
matrix to quantify similarity (rather than dissimilarity)</li>
<li>Input kernel matrix in a kernel machine regression framework with an
outcome.</li>
</ol>
<p>The construction of the dissimilarity and kernel matrices occurs
separately for both connected components and loops. We first start by
generating pairs of sample IDs to iterate through. Then we initialize
our pairwise
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>38</mn><mo>×</mo><mn>38</mn></mrow><annotation encoding="application/x-tex">38\times 38</annotation></semantics></math>
distance matrices. Then we iterate through all the pairs of persistence
diagrams and calculate the distance between them.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create all pairs of samples</span></span>
<span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu">gtools</span><span class="fu">::</span><span class="fu">combinations</span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, r <span class="op">=</span> <span class="fl">2</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">PIDs</span><span class="op">)</span>, repeats.allowed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initialize a distance matrix (comparing the matrices based on distance)</span></span>
<span><span class="va">dist.mat.deg0</span> <span class="op">&lt;-</span> <span class="va">dist.mat.deg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg1</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">PIDs</span></span>
<span></span>
<span><span class="co"># Iterate through pairs and calculate distance</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Print progress</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Save the current pair</span></span>
<span>  <span class="va">ids</span> <span class="op">&lt;-</span> <span class="va">pairs</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span></span>
<span>  <span class="va">id.1</span> <span class="op">&lt;-</span> <span class="va">ids</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">id.2</span> <span class="op">&lt;-</span> <span class="va">ids</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Load in the diagrams</span></span>
<span>  <span class="va">rips.1</span> <span class="op">&lt;-</span> <span class="va">PD.list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">PIDs</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">id.1</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">rips.2</span> <span class="op">&lt;-</span> <span class="va">PD.list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">PIDs</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">id.2</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Calculate distance</span></span>
<span>  <span class="va">dist.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TDAstats/man/phom.dist.html" class="external-link">phom.dist</a></span><span class="op">(</span><span class="va">rips.1</span>, <span class="va">rips.2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Save the results</span></span>
<span>  <span class="va">row.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span> <span class="op">==</span> <span class="va">id.1</span><span class="op">)</span></span>
<span>  <span class="va">col.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span> <span class="op">==</span> <span class="va">id.2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">dist.mat.deg0</span><span class="op">[</span><span class="va">row.ind</span>, <span class="va">col.ind</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dist.i</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">dist.mat.deg1</span><span class="op">[</span><span class="va">row.ind</span>, <span class="va">col.ind</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dist.i</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "1/703"</span></span>
<span><span class="co">#&gt; [1] "2/703"</span></span>
<span><span class="co">#&gt; [1] "3/703"</span></span>
<span><span class="co">#&gt; [1] "4/703"</span></span>
<span><span class="co">#&gt; [1] "5/703"</span></span>
<span><span class="co">#&gt; [1] "6/703"</span></span>
<span><span class="co">#&gt; [1] "7/703"</span></span>
<span><span class="co">#&gt; [1] "8/703"</span></span>
<span><span class="co">#&gt; [1] "9/703"</span></span>
<span><span class="co">#&gt; [1] "10/703"</span></span>
<span><span class="co">#&gt; [1] "11/703"</span></span>
<span><span class="co">#&gt; [1] "12/703"</span></span>
<span><span class="co">#&gt; [1] "13/703"</span></span>
<span><span class="co">#&gt; [1] "14/703"</span></span>
<span><span class="co">#&gt; [1] "15/703"</span></span>
<span><span class="co">#&gt; [1] "16/703"</span></span>
<span><span class="co">#&gt; [1] "17/703"</span></span>
<span><span class="co">#&gt; [1] "18/703"</span></span>
<span><span class="co">#&gt; [1] "19/703"</span></span>
<span><span class="co">#&gt; [1] "20/703"</span></span>
<span><span class="co">#&gt; [1] "21/703"</span></span>
<span><span class="co">#&gt; [1] "22/703"</span></span>
<span><span class="co">#&gt; [1] "23/703"</span></span>
<span><span class="co">#&gt; [1] "24/703"</span></span>
<span><span class="co">#&gt; [1] "25/703"</span></span>
<span><span class="co">#&gt; [1] "26/703"</span></span>
<span><span class="co">#&gt; [1] "27/703"</span></span>
<span><span class="co">#&gt; [1] "28/703"</span></span>
<span><span class="co">#&gt; [1] "29/703"</span></span>
<span><span class="co">#&gt; [1] "30/703"</span></span>
<span><span class="co">#&gt; [1] "31/703"</span></span>
<span><span class="co">#&gt; [1] "32/703"</span></span>
<span><span class="co">#&gt; [1] "33/703"</span></span>
<span><span class="co">#&gt; [1] "34/703"</span></span>
<span><span class="co">#&gt; [1] "35/703"</span></span>
<span><span class="co">#&gt; [1] "36/703"</span></span>
<span><span class="co">#&gt; [1] "37/703"</span></span>
<span><span class="co">#&gt; [1] "38/703"</span></span>
<span><span class="co">#&gt; [1] "39/703"</span></span>
<span><span class="co">#&gt; [1] "40/703"</span></span>
<span><span class="co">#&gt; [1] "41/703"</span></span>
<span><span class="co">#&gt; [1] "42/703"</span></span>
<span><span class="co">#&gt; [1] "43/703"</span></span>
<span><span class="co">#&gt; [1] "44/703"</span></span>
<span><span class="co">#&gt; [1] "45/703"</span></span>
<span><span class="co">#&gt; [1] "46/703"</span></span>
<span><span class="co">#&gt; [1] "47/703"</span></span>
<span><span class="co">#&gt; [1] "48/703"</span></span>
<span><span class="co">#&gt; [1] "49/703"</span></span>
<span><span class="co">#&gt; [1] "50/703"</span></span>
<span><span class="co">#&gt; [1] "51/703"</span></span>
<span><span class="co">#&gt; [1] "52/703"</span></span>
<span><span class="co">#&gt; [1] "53/703"</span></span>
<span><span class="co">#&gt; [1] "54/703"</span></span>
<span><span class="co">#&gt; [1] "55/703"</span></span>
<span><span class="co">#&gt; [1] "56/703"</span></span>
<span><span class="co">#&gt; [1] "57/703"</span></span>
<span><span class="co">#&gt; [1] "58/703"</span></span>
<span><span class="co">#&gt; [1] "59/703"</span></span>
<span><span class="co">#&gt; [1] "60/703"</span></span>
<span><span class="co">#&gt; [1] "61/703"</span></span>
<span><span class="co">#&gt; [1] "62/703"</span></span>
<span><span class="co">#&gt; [1] "63/703"</span></span>
<span><span class="co">#&gt; [1] "64/703"</span></span>
<span><span class="co">#&gt; [1] "65/703"</span></span>
<span><span class="co">#&gt; [1] "66/703"</span></span>
<span><span class="co">#&gt; [1] "67/703"</span></span>
<span><span class="co">#&gt; [1] "68/703"</span></span>
<span><span class="co">#&gt; [1] "69/703"</span></span>
<span><span class="co">#&gt; [1] "70/703"</span></span>
<span><span class="co">#&gt; [1] "71/703"</span></span>
<span><span class="co">#&gt; [1] "72/703"</span></span>
<span><span class="co">#&gt; [1] "73/703"</span></span>
<span><span class="co">#&gt; [1] "74/703"</span></span>
<span><span class="co">#&gt; [1] "75/703"</span></span>
<span><span class="co">#&gt; [1] "76/703"</span></span>
<span><span class="co">#&gt; [1] "77/703"</span></span>
<span><span class="co">#&gt; [1] "78/703"</span></span>
<span><span class="co">#&gt; [1] "79/703"</span></span>
<span><span class="co">#&gt; [1] "80/703"</span></span>
<span><span class="co">#&gt; [1] "81/703"</span></span>
<span><span class="co">#&gt; [1] "82/703"</span></span>
<span><span class="co">#&gt; [1] "83/703"</span></span>
<span><span class="co">#&gt; [1] "84/703"</span></span>
<span><span class="co">#&gt; [1] "85/703"</span></span>
<span><span class="co">#&gt; [1] "86/703"</span></span>
<span><span class="co">#&gt; [1] "87/703"</span></span>
<span><span class="co">#&gt; [1] "88/703"</span></span>
<span><span class="co">#&gt; [1] "89/703"</span></span>
<span><span class="co">#&gt; [1] "90/703"</span></span>
<span><span class="co">#&gt; [1] "91/703"</span></span>
<span><span class="co">#&gt; [1] "92/703"</span></span>
<span><span class="co">#&gt; [1] "93/703"</span></span>
<span><span class="co">#&gt; [1] "94/703"</span></span>
<span><span class="co">#&gt; [1] "95/703"</span></span>
<span><span class="co">#&gt; [1] "96/703"</span></span>
<span><span class="co">#&gt; [1] "97/703"</span></span>
<span><span class="co">#&gt; [1] "98/703"</span></span>
<span><span class="co">#&gt; [1] "99/703"</span></span>
<span><span class="co">#&gt; [1] "100/703"</span></span>
<span><span class="co">#&gt; [1] "101/703"</span></span>
<span><span class="co">#&gt; [1] "102/703"</span></span>
<span><span class="co">#&gt; [1] "103/703"</span></span>
<span><span class="co">#&gt; [1] "104/703"</span></span>
<span><span class="co">#&gt; [1] "105/703"</span></span>
<span><span class="co">#&gt; [1] "106/703"</span></span>
<span><span class="co">#&gt; [1] "107/703"</span></span>
<span><span class="co">#&gt; [1] "108/703"</span></span>
<span><span class="co">#&gt; [1] "109/703"</span></span>
<span><span class="co">#&gt; [1] "110/703"</span></span>
<span><span class="co">#&gt; [1] "111/703"</span></span>
<span><span class="co">#&gt; [1] "112/703"</span></span>
<span><span class="co">#&gt; [1] "113/703"</span></span>
<span><span class="co">#&gt; [1] "114/703"</span></span>
<span><span class="co">#&gt; [1] "115/703"</span></span>
<span><span class="co">#&gt; [1] "116/703"</span></span>
<span><span class="co">#&gt; [1] "117/703"</span></span>
<span><span class="co">#&gt; [1] "118/703"</span></span>
<span><span class="co">#&gt; [1] "119/703"</span></span>
<span><span class="co">#&gt; [1] "120/703"</span></span>
<span><span class="co">#&gt; [1] "121/703"</span></span>
<span><span class="co">#&gt; [1] "122/703"</span></span>
<span><span class="co">#&gt; [1] "123/703"</span></span>
<span><span class="co">#&gt; [1] "124/703"</span></span>
<span><span class="co">#&gt; [1] "125/703"</span></span>
<span><span class="co">#&gt; [1] "126/703"</span></span>
<span><span class="co">#&gt; [1] "127/703"</span></span>
<span><span class="co">#&gt; [1] "128/703"</span></span>
<span><span class="co">#&gt; [1] "129/703"</span></span>
<span><span class="co">#&gt; [1] "130/703"</span></span>
<span><span class="co">#&gt; [1] "131/703"</span></span>
<span><span class="co">#&gt; [1] "132/703"</span></span>
<span><span class="co">#&gt; [1] "133/703"</span></span>
<span><span class="co">#&gt; [1] "134/703"</span></span>
<span><span class="co">#&gt; [1] "135/703"</span></span>
<span><span class="co">#&gt; [1] "136/703"</span></span>
<span><span class="co">#&gt; [1] "137/703"</span></span>
<span><span class="co">#&gt; [1] "138/703"</span></span>
<span><span class="co">#&gt; [1] "139/703"</span></span>
<span><span class="co">#&gt; [1] "140/703"</span></span>
<span><span class="co">#&gt; [1] "141/703"</span></span>
<span><span class="co">#&gt; [1] "142/703"</span></span>
<span><span class="co">#&gt; [1] "143/703"</span></span>
<span><span class="co">#&gt; [1] "144/703"</span></span>
<span><span class="co">#&gt; [1] "145/703"</span></span>
<span><span class="co">#&gt; [1] "146/703"</span></span>
<span><span class="co">#&gt; [1] "147/703"</span></span>
<span><span class="co">#&gt; [1] "148/703"</span></span>
<span><span class="co">#&gt; [1] "149/703"</span></span>
<span><span class="co">#&gt; [1] "150/703"</span></span>
<span><span class="co">#&gt; [1] "151/703"</span></span>
<span><span class="co">#&gt; [1] "152/703"</span></span>
<span><span class="co">#&gt; [1] "153/703"</span></span>
<span><span class="co">#&gt; [1] "154/703"</span></span>
<span><span class="co">#&gt; [1] "155/703"</span></span>
<span><span class="co">#&gt; [1] "156/703"</span></span>
<span><span class="co">#&gt; [1] "157/703"</span></span>
<span><span class="co">#&gt; [1] "158/703"</span></span>
<span><span class="co">#&gt; [1] "159/703"</span></span>
<span><span class="co">#&gt; [1] "160/703"</span></span>
<span><span class="co">#&gt; [1] "161/703"</span></span>
<span><span class="co">#&gt; [1] "162/703"</span></span>
<span><span class="co">#&gt; [1] "163/703"</span></span>
<span><span class="co">#&gt; [1] "164/703"</span></span>
<span><span class="co">#&gt; [1] "165/703"</span></span>
<span><span class="co">#&gt; [1] "166/703"</span></span>
<span><span class="co">#&gt; [1] "167/703"</span></span>
<span><span class="co">#&gt; [1] "168/703"</span></span>
<span><span class="co">#&gt; [1] "169/703"</span></span>
<span><span class="co">#&gt; [1] "170/703"</span></span>
<span><span class="co">#&gt; [1] "171/703"</span></span>
<span><span class="co">#&gt; [1] "172/703"</span></span>
<span><span class="co">#&gt; [1] "173/703"</span></span>
<span><span class="co">#&gt; [1] "174/703"</span></span>
<span><span class="co">#&gt; [1] "175/703"</span></span>
<span><span class="co">#&gt; [1] "176/703"</span></span>
<span><span class="co">#&gt; [1] "177/703"</span></span>
<span><span class="co">#&gt; [1] "178/703"</span></span>
<span><span class="co">#&gt; [1] "179/703"</span></span>
<span><span class="co">#&gt; [1] "180/703"</span></span>
<span><span class="co">#&gt; [1] "181/703"</span></span>
<span><span class="co">#&gt; [1] "182/703"</span></span>
<span><span class="co">#&gt; [1] "183/703"</span></span>
<span><span class="co">#&gt; [1] "184/703"</span></span>
<span><span class="co">#&gt; [1] "185/703"</span></span>
<span><span class="co">#&gt; [1] "186/703"</span></span>
<span><span class="co">#&gt; [1] "187/703"</span></span>
<span><span class="co">#&gt; [1] "188/703"</span></span>
<span><span class="co">#&gt; [1] "189/703"</span></span>
<span><span class="co">#&gt; [1] "190/703"</span></span>
<span><span class="co">#&gt; [1] "191/703"</span></span>
<span><span class="co">#&gt; [1] "192/703"</span></span>
<span><span class="co">#&gt; [1] "193/703"</span></span>
<span><span class="co">#&gt; [1] "194/703"</span></span>
<span><span class="co">#&gt; [1] "195/703"</span></span>
<span><span class="co">#&gt; [1] "196/703"</span></span>
<span><span class="co">#&gt; [1] "197/703"</span></span>
<span><span class="co">#&gt; [1] "198/703"</span></span>
<span><span class="co">#&gt; [1] "199/703"</span></span>
<span><span class="co">#&gt; [1] "200/703"</span></span>
<span><span class="co">#&gt; [1] "201/703"</span></span>
<span><span class="co">#&gt; [1] "202/703"</span></span>
<span><span class="co">#&gt; [1] "203/703"</span></span>
<span><span class="co">#&gt; [1] "204/703"</span></span>
<span><span class="co">#&gt; [1] "205/703"</span></span>
<span><span class="co">#&gt; [1] "206/703"</span></span>
<span><span class="co">#&gt; [1] "207/703"</span></span>
<span><span class="co">#&gt; [1] "208/703"</span></span>
<span><span class="co">#&gt; [1] "209/703"</span></span>
<span><span class="co">#&gt; [1] "210/703"</span></span>
<span><span class="co">#&gt; [1] "211/703"</span></span>
<span><span class="co">#&gt; [1] "212/703"</span></span>
<span><span class="co">#&gt; [1] "213/703"</span></span>
<span><span class="co">#&gt; [1] "214/703"</span></span>
<span><span class="co">#&gt; [1] "215/703"</span></span>
<span><span class="co">#&gt; [1] "216/703"</span></span>
<span><span class="co">#&gt; [1] "217/703"</span></span>
<span><span class="co">#&gt; [1] "218/703"</span></span>
<span><span class="co">#&gt; [1] "219/703"</span></span>
<span><span class="co">#&gt; [1] "220/703"</span></span>
<span><span class="co">#&gt; [1] "221/703"</span></span>
<span><span class="co">#&gt; [1] "222/703"</span></span>
<span><span class="co">#&gt; [1] "223/703"</span></span>
<span><span class="co">#&gt; [1] "224/703"</span></span>
<span><span class="co">#&gt; [1] "225/703"</span></span>
<span><span class="co">#&gt; [1] "226/703"</span></span>
<span><span class="co">#&gt; [1] "227/703"</span></span>
<span><span class="co">#&gt; [1] "228/703"</span></span>
<span><span class="co">#&gt; [1] "229/703"</span></span>
<span><span class="co">#&gt; [1] "230/703"</span></span>
<span><span class="co">#&gt; [1] "231/703"</span></span>
<span><span class="co">#&gt; [1] "232/703"</span></span>
<span><span class="co">#&gt; [1] "233/703"</span></span>
<span><span class="co">#&gt; [1] "234/703"</span></span>
<span><span class="co">#&gt; [1] "235/703"</span></span>
<span><span class="co">#&gt; [1] "236/703"</span></span>
<span><span class="co">#&gt; [1] "237/703"</span></span>
<span><span class="co">#&gt; [1] "238/703"</span></span>
<span><span class="co">#&gt; [1] "239/703"</span></span>
<span><span class="co">#&gt; [1] "240/703"</span></span>
<span><span class="co">#&gt; [1] "241/703"</span></span>
<span><span class="co">#&gt; [1] "242/703"</span></span>
<span><span class="co">#&gt; [1] "243/703"</span></span>
<span><span class="co">#&gt; [1] "244/703"</span></span>
<span><span class="co">#&gt; [1] "245/703"</span></span>
<span><span class="co">#&gt; [1] "246/703"</span></span>
<span><span class="co">#&gt; [1] "247/703"</span></span>
<span><span class="co">#&gt; [1] "248/703"</span></span>
<span><span class="co">#&gt; [1] "249/703"</span></span>
<span><span class="co">#&gt; [1] "250/703"</span></span>
<span><span class="co">#&gt; [1] "251/703"</span></span>
<span><span class="co">#&gt; [1] "252/703"</span></span>
<span><span class="co">#&gt; [1] "253/703"</span></span>
<span><span class="co">#&gt; [1] "254/703"</span></span>
<span><span class="co">#&gt; [1] "255/703"</span></span>
<span><span class="co">#&gt; [1] "256/703"</span></span>
<span><span class="co">#&gt; [1] "257/703"</span></span>
<span><span class="co">#&gt; [1] "258/703"</span></span>
<span><span class="co">#&gt; [1] "259/703"</span></span>
<span><span class="co">#&gt; [1] "260/703"</span></span>
<span><span class="co">#&gt; [1] "261/703"</span></span>
<span><span class="co">#&gt; [1] "262/703"</span></span>
<span><span class="co">#&gt; [1] "263/703"</span></span>
<span><span class="co">#&gt; [1] "264/703"</span></span>
<span><span class="co">#&gt; [1] "265/703"</span></span>
<span><span class="co">#&gt; [1] "266/703"</span></span>
<span><span class="co">#&gt; [1] "267/703"</span></span>
<span><span class="co">#&gt; [1] "268/703"</span></span>
<span><span class="co">#&gt; [1] "269/703"</span></span>
<span><span class="co">#&gt; [1] "270/703"</span></span>
<span><span class="co">#&gt; [1] "271/703"</span></span>
<span><span class="co">#&gt; [1] "272/703"</span></span>
<span><span class="co">#&gt; [1] "273/703"</span></span>
<span><span class="co">#&gt; [1] "274/703"</span></span>
<span><span class="co">#&gt; [1] "275/703"</span></span>
<span><span class="co">#&gt; [1] "276/703"</span></span>
<span><span class="co">#&gt; [1] "277/703"</span></span>
<span><span class="co">#&gt; [1] "278/703"</span></span>
<span><span class="co">#&gt; [1] "279/703"</span></span>
<span><span class="co">#&gt; [1] "280/703"</span></span>
<span><span class="co">#&gt; [1] "281/703"</span></span>
<span><span class="co">#&gt; [1] "282/703"</span></span>
<span><span class="co">#&gt; [1] "283/703"</span></span>
<span><span class="co">#&gt; [1] "284/703"</span></span>
<span><span class="co">#&gt; [1] "285/703"</span></span>
<span><span class="co">#&gt; [1] "286/703"</span></span>
<span><span class="co">#&gt; [1] "287/703"</span></span>
<span><span class="co">#&gt; [1] "288/703"</span></span>
<span><span class="co">#&gt; [1] "289/703"</span></span>
<span><span class="co">#&gt; [1] "290/703"</span></span>
<span><span class="co">#&gt; [1] "291/703"</span></span>
<span><span class="co">#&gt; [1] "292/703"</span></span>
<span><span class="co">#&gt; [1] "293/703"</span></span>
<span><span class="co">#&gt; [1] "294/703"</span></span>
<span><span class="co">#&gt; [1] "295/703"</span></span>
<span><span class="co">#&gt; [1] "296/703"</span></span>
<span><span class="co">#&gt; [1] "297/703"</span></span>
<span><span class="co">#&gt; [1] "298/703"</span></span>
<span><span class="co">#&gt; [1] "299/703"</span></span>
<span><span class="co">#&gt; [1] "300/703"</span></span>
<span><span class="co">#&gt; [1] "301/703"</span></span>
<span><span class="co">#&gt; [1] "302/703"</span></span>
<span><span class="co">#&gt; [1] "303/703"</span></span>
<span><span class="co">#&gt; [1] "304/703"</span></span>
<span><span class="co">#&gt; [1] "305/703"</span></span>
<span><span class="co">#&gt; [1] "306/703"</span></span>
<span><span class="co">#&gt; [1] "307/703"</span></span>
<span><span class="co">#&gt; [1] "308/703"</span></span>
<span><span class="co">#&gt; [1] "309/703"</span></span>
<span><span class="co">#&gt; [1] "310/703"</span></span>
<span><span class="co">#&gt; [1] "311/703"</span></span>
<span><span class="co">#&gt; [1] "312/703"</span></span>
<span><span class="co">#&gt; [1] "313/703"</span></span>
<span><span class="co">#&gt; [1] "314/703"</span></span>
<span><span class="co">#&gt; [1] "315/703"</span></span>
<span><span class="co">#&gt; [1] "316/703"</span></span>
<span><span class="co">#&gt; [1] "317/703"</span></span>
<span><span class="co">#&gt; [1] "318/703"</span></span>
<span><span class="co">#&gt; [1] "319/703"</span></span>
<span><span class="co">#&gt; [1] "320/703"</span></span>
<span><span class="co">#&gt; [1] "321/703"</span></span>
<span><span class="co">#&gt; [1] "322/703"</span></span>
<span><span class="co">#&gt; [1] "323/703"</span></span>
<span><span class="co">#&gt; [1] "324/703"</span></span>
<span><span class="co">#&gt; [1] "325/703"</span></span>
<span><span class="co">#&gt; [1] "326/703"</span></span>
<span><span class="co">#&gt; [1] "327/703"</span></span>
<span><span class="co">#&gt; [1] "328/703"</span></span>
<span><span class="co">#&gt; [1] "329/703"</span></span>
<span><span class="co">#&gt; [1] "330/703"</span></span>
<span><span class="co">#&gt; [1] "331/703"</span></span>
<span><span class="co">#&gt; [1] "332/703"</span></span>
<span><span class="co">#&gt; [1] "333/703"</span></span>
<span><span class="co">#&gt; [1] "334/703"</span></span>
<span><span class="co">#&gt; [1] "335/703"</span></span>
<span><span class="co">#&gt; [1] "336/703"</span></span>
<span><span class="co">#&gt; [1] "337/703"</span></span>
<span><span class="co">#&gt; [1] "338/703"</span></span>
<span><span class="co">#&gt; [1] "339/703"</span></span>
<span><span class="co">#&gt; [1] "340/703"</span></span>
<span><span class="co">#&gt; [1] "341/703"</span></span>
<span><span class="co">#&gt; [1] "342/703"</span></span>
<span><span class="co">#&gt; [1] "343/703"</span></span>
<span><span class="co">#&gt; [1] "344/703"</span></span>
<span><span class="co">#&gt; [1] "345/703"</span></span>
<span><span class="co">#&gt; [1] "346/703"</span></span>
<span><span class="co">#&gt; [1] "347/703"</span></span>
<span><span class="co">#&gt; [1] "348/703"</span></span>
<span><span class="co">#&gt; [1] "349/703"</span></span>
<span><span class="co">#&gt; [1] "350/703"</span></span>
<span><span class="co">#&gt; [1] "351/703"</span></span>
<span><span class="co">#&gt; [1] "352/703"</span></span>
<span><span class="co">#&gt; [1] "353/703"</span></span>
<span><span class="co">#&gt; [1] "354/703"</span></span>
<span><span class="co">#&gt; [1] "355/703"</span></span>
<span><span class="co">#&gt; [1] "356/703"</span></span>
<span><span class="co">#&gt; [1] "357/703"</span></span>
<span><span class="co">#&gt; [1] "358/703"</span></span>
<span><span class="co">#&gt; [1] "359/703"</span></span>
<span><span class="co">#&gt; [1] "360/703"</span></span>
<span><span class="co">#&gt; [1] "361/703"</span></span>
<span><span class="co">#&gt; [1] "362/703"</span></span>
<span><span class="co">#&gt; [1] "363/703"</span></span>
<span><span class="co">#&gt; [1] "364/703"</span></span>
<span><span class="co">#&gt; [1] "365/703"</span></span>
<span><span class="co">#&gt; [1] "366/703"</span></span>
<span><span class="co">#&gt; [1] "367/703"</span></span>
<span><span class="co">#&gt; [1] "368/703"</span></span>
<span><span class="co">#&gt; [1] "369/703"</span></span>
<span><span class="co">#&gt; [1] "370/703"</span></span>
<span><span class="co">#&gt; [1] "371/703"</span></span>
<span><span class="co">#&gt; [1] "372/703"</span></span>
<span><span class="co">#&gt; [1] "373/703"</span></span>
<span><span class="co">#&gt; [1] "374/703"</span></span>
<span><span class="co">#&gt; [1] "375/703"</span></span>
<span><span class="co">#&gt; [1] "376/703"</span></span>
<span><span class="co">#&gt; [1] "377/703"</span></span>
<span><span class="co">#&gt; [1] "378/703"</span></span>
<span><span class="co">#&gt; [1] "379/703"</span></span>
<span><span class="co">#&gt; [1] "380/703"</span></span>
<span><span class="co">#&gt; [1] "381/703"</span></span>
<span><span class="co">#&gt; [1] "382/703"</span></span>
<span><span class="co">#&gt; [1] "383/703"</span></span>
<span><span class="co">#&gt; [1] "384/703"</span></span>
<span><span class="co">#&gt; [1] "385/703"</span></span>
<span><span class="co">#&gt; [1] "386/703"</span></span>
<span><span class="co">#&gt; [1] "387/703"</span></span>
<span><span class="co">#&gt; [1] "388/703"</span></span>
<span><span class="co">#&gt; [1] "389/703"</span></span>
<span><span class="co">#&gt; [1] "390/703"</span></span>
<span><span class="co">#&gt; [1] "391/703"</span></span>
<span><span class="co">#&gt; [1] "392/703"</span></span>
<span><span class="co">#&gt; [1] "393/703"</span></span>
<span><span class="co">#&gt; [1] "394/703"</span></span>
<span><span class="co">#&gt; [1] "395/703"</span></span>
<span><span class="co">#&gt; [1] "396/703"</span></span>
<span><span class="co">#&gt; [1] "397/703"</span></span>
<span><span class="co">#&gt; [1] "398/703"</span></span>
<span><span class="co">#&gt; [1] "399/703"</span></span>
<span><span class="co">#&gt; [1] "400/703"</span></span>
<span><span class="co">#&gt; [1] "401/703"</span></span>
<span><span class="co">#&gt; [1] "402/703"</span></span>
<span><span class="co">#&gt; [1] "403/703"</span></span>
<span><span class="co">#&gt; [1] "404/703"</span></span>
<span><span class="co">#&gt; [1] "405/703"</span></span>
<span><span class="co">#&gt; [1] "406/703"</span></span>
<span><span class="co">#&gt; [1] "407/703"</span></span>
<span><span class="co">#&gt; [1] "408/703"</span></span>
<span><span class="co">#&gt; [1] "409/703"</span></span>
<span><span class="co">#&gt; [1] "410/703"</span></span>
<span><span class="co">#&gt; [1] "411/703"</span></span>
<span><span class="co">#&gt; [1] "412/703"</span></span>
<span><span class="co">#&gt; [1] "413/703"</span></span>
<span><span class="co">#&gt; [1] "414/703"</span></span>
<span><span class="co">#&gt; [1] "415/703"</span></span>
<span><span class="co">#&gt; [1] "416/703"</span></span>
<span><span class="co">#&gt; [1] "417/703"</span></span>
<span><span class="co">#&gt; [1] "418/703"</span></span>
<span><span class="co">#&gt; [1] "419/703"</span></span>
<span><span class="co">#&gt; [1] "420/703"</span></span>
<span><span class="co">#&gt; [1] "421/703"</span></span>
<span><span class="co">#&gt; [1] "422/703"</span></span>
<span><span class="co">#&gt; [1] "423/703"</span></span>
<span><span class="co">#&gt; [1] "424/703"</span></span>
<span><span class="co">#&gt; [1] "425/703"</span></span>
<span><span class="co">#&gt; [1] "426/703"</span></span>
<span><span class="co">#&gt; [1] "427/703"</span></span>
<span><span class="co">#&gt; [1] "428/703"</span></span>
<span><span class="co">#&gt; [1] "429/703"</span></span>
<span><span class="co">#&gt; [1] "430/703"</span></span>
<span><span class="co">#&gt; [1] "431/703"</span></span>
<span><span class="co">#&gt; [1] "432/703"</span></span>
<span><span class="co">#&gt; [1] "433/703"</span></span>
<span><span class="co">#&gt; [1] "434/703"</span></span>
<span><span class="co">#&gt; [1] "435/703"</span></span>
<span><span class="co">#&gt; [1] "436/703"</span></span>
<span><span class="co">#&gt; [1] "437/703"</span></span>
<span><span class="co">#&gt; [1] "438/703"</span></span>
<span><span class="co">#&gt; [1] "439/703"</span></span>
<span><span class="co">#&gt; [1] "440/703"</span></span>
<span><span class="co">#&gt; [1] "441/703"</span></span>
<span><span class="co">#&gt; [1] "442/703"</span></span>
<span><span class="co">#&gt; [1] "443/703"</span></span>
<span><span class="co">#&gt; [1] "444/703"</span></span>
<span><span class="co">#&gt; [1] "445/703"</span></span>
<span><span class="co">#&gt; [1] "446/703"</span></span>
<span><span class="co">#&gt; [1] "447/703"</span></span>
<span><span class="co">#&gt; [1] "448/703"</span></span>
<span><span class="co">#&gt; [1] "449/703"</span></span>
<span><span class="co">#&gt; [1] "450/703"</span></span>
<span><span class="co">#&gt; [1] "451/703"</span></span>
<span><span class="co">#&gt; [1] "452/703"</span></span>
<span><span class="co">#&gt; [1] "453/703"</span></span>
<span><span class="co">#&gt; [1] "454/703"</span></span>
<span><span class="co">#&gt; [1] "455/703"</span></span>
<span><span class="co">#&gt; [1] "456/703"</span></span>
<span><span class="co">#&gt; [1] "457/703"</span></span>
<span><span class="co">#&gt; [1] "458/703"</span></span>
<span><span class="co">#&gt; [1] "459/703"</span></span>
<span><span class="co">#&gt; [1] "460/703"</span></span>
<span><span class="co">#&gt; [1] "461/703"</span></span>
<span><span class="co">#&gt; [1] "462/703"</span></span>
<span><span class="co">#&gt; [1] "463/703"</span></span>
<span><span class="co">#&gt; [1] "464/703"</span></span>
<span><span class="co">#&gt; [1] "465/703"</span></span>
<span><span class="co">#&gt; [1] "466/703"</span></span>
<span><span class="co">#&gt; [1] "467/703"</span></span>
<span><span class="co">#&gt; [1] "468/703"</span></span>
<span><span class="co">#&gt; [1] "469/703"</span></span>
<span><span class="co">#&gt; [1] "470/703"</span></span>
<span><span class="co">#&gt; [1] "471/703"</span></span>
<span><span class="co">#&gt; [1] "472/703"</span></span>
<span><span class="co">#&gt; [1] "473/703"</span></span>
<span><span class="co">#&gt; [1] "474/703"</span></span>
<span><span class="co">#&gt; [1] "475/703"</span></span>
<span><span class="co">#&gt; [1] "476/703"</span></span>
<span><span class="co">#&gt; [1] "477/703"</span></span>
<span><span class="co">#&gt; [1] "478/703"</span></span>
<span><span class="co">#&gt; [1] "479/703"</span></span>
<span><span class="co">#&gt; [1] "480/703"</span></span>
<span><span class="co">#&gt; [1] "481/703"</span></span>
<span><span class="co">#&gt; [1] "482/703"</span></span>
<span><span class="co">#&gt; [1] "483/703"</span></span>
<span><span class="co">#&gt; [1] "484/703"</span></span>
<span><span class="co">#&gt; [1] "485/703"</span></span>
<span><span class="co">#&gt; [1] "486/703"</span></span>
<span><span class="co">#&gt; [1] "487/703"</span></span>
<span><span class="co">#&gt; [1] "488/703"</span></span>
<span><span class="co">#&gt; [1] "489/703"</span></span>
<span><span class="co">#&gt; [1] "490/703"</span></span>
<span><span class="co">#&gt; [1] "491/703"</span></span>
<span><span class="co">#&gt; [1] "492/703"</span></span>
<span><span class="co">#&gt; [1] "493/703"</span></span>
<span><span class="co">#&gt; [1] "494/703"</span></span>
<span><span class="co">#&gt; [1] "495/703"</span></span>
<span><span class="co">#&gt; [1] "496/703"</span></span>
<span><span class="co">#&gt; [1] "497/703"</span></span>
<span><span class="co">#&gt; [1] "498/703"</span></span>
<span><span class="co">#&gt; [1] "499/703"</span></span>
<span><span class="co">#&gt; [1] "500/703"</span></span>
<span><span class="co">#&gt; [1] "501/703"</span></span>
<span><span class="co">#&gt; [1] "502/703"</span></span>
<span><span class="co">#&gt; [1] "503/703"</span></span>
<span><span class="co">#&gt; [1] "504/703"</span></span>
<span><span class="co">#&gt; [1] "505/703"</span></span>
<span><span class="co">#&gt; [1] "506/703"</span></span>
<span><span class="co">#&gt; [1] "507/703"</span></span>
<span><span class="co">#&gt; [1] "508/703"</span></span>
<span><span class="co">#&gt; [1] "509/703"</span></span>
<span><span class="co">#&gt; [1] "510/703"</span></span>
<span><span class="co">#&gt; [1] "511/703"</span></span>
<span><span class="co">#&gt; [1] "512/703"</span></span>
<span><span class="co">#&gt; [1] "513/703"</span></span>
<span><span class="co">#&gt; [1] "514/703"</span></span>
<span><span class="co">#&gt; [1] "515/703"</span></span>
<span><span class="co">#&gt; [1] "516/703"</span></span>
<span><span class="co">#&gt; [1] "517/703"</span></span>
<span><span class="co">#&gt; [1] "518/703"</span></span>
<span><span class="co">#&gt; [1] "519/703"</span></span>
<span><span class="co">#&gt; [1] "520/703"</span></span>
<span><span class="co">#&gt; [1] "521/703"</span></span>
<span><span class="co">#&gt; [1] "522/703"</span></span>
<span><span class="co">#&gt; [1] "523/703"</span></span>
<span><span class="co">#&gt; [1] "524/703"</span></span>
<span><span class="co">#&gt; [1] "525/703"</span></span>
<span><span class="co">#&gt; [1] "526/703"</span></span>
<span><span class="co">#&gt; [1] "527/703"</span></span>
<span><span class="co">#&gt; [1] "528/703"</span></span>
<span><span class="co">#&gt; [1] "529/703"</span></span>
<span><span class="co">#&gt; [1] "530/703"</span></span>
<span><span class="co">#&gt; [1] "531/703"</span></span>
<span><span class="co">#&gt; [1] "532/703"</span></span>
<span><span class="co">#&gt; [1] "533/703"</span></span>
<span><span class="co">#&gt; [1] "534/703"</span></span>
<span><span class="co">#&gt; [1] "535/703"</span></span>
<span><span class="co">#&gt; [1] "536/703"</span></span>
<span><span class="co">#&gt; [1] "537/703"</span></span>
<span><span class="co">#&gt; [1] "538/703"</span></span>
<span><span class="co">#&gt; [1] "539/703"</span></span>
<span><span class="co">#&gt; [1] "540/703"</span></span>
<span><span class="co">#&gt; [1] "541/703"</span></span>
<span><span class="co">#&gt; [1] "542/703"</span></span>
<span><span class="co">#&gt; [1] "543/703"</span></span>
<span><span class="co">#&gt; [1] "544/703"</span></span>
<span><span class="co">#&gt; [1] "545/703"</span></span>
<span><span class="co">#&gt; [1] "546/703"</span></span>
<span><span class="co">#&gt; [1] "547/703"</span></span>
<span><span class="co">#&gt; [1] "548/703"</span></span>
<span><span class="co">#&gt; [1] "549/703"</span></span>
<span><span class="co">#&gt; [1] "550/703"</span></span>
<span><span class="co">#&gt; [1] "551/703"</span></span>
<span><span class="co">#&gt; [1] "552/703"</span></span>
<span><span class="co">#&gt; [1] "553/703"</span></span>
<span><span class="co">#&gt; [1] "554/703"</span></span>
<span><span class="co">#&gt; [1] "555/703"</span></span>
<span><span class="co">#&gt; [1] "556/703"</span></span>
<span><span class="co">#&gt; [1] "557/703"</span></span>
<span><span class="co">#&gt; [1] "558/703"</span></span>
<span><span class="co">#&gt; [1] "559/703"</span></span>
<span><span class="co">#&gt; [1] "560/703"</span></span>
<span><span class="co">#&gt; [1] "561/703"</span></span>
<span><span class="co">#&gt; [1] "562/703"</span></span>
<span><span class="co">#&gt; [1] "563/703"</span></span>
<span><span class="co">#&gt; [1] "564/703"</span></span>
<span><span class="co">#&gt; [1] "565/703"</span></span>
<span><span class="co">#&gt; [1] "566/703"</span></span>
<span><span class="co">#&gt; [1] "567/703"</span></span>
<span><span class="co">#&gt; [1] "568/703"</span></span>
<span><span class="co">#&gt; [1] "569/703"</span></span>
<span><span class="co">#&gt; [1] "570/703"</span></span>
<span><span class="co">#&gt; [1] "571/703"</span></span>
<span><span class="co">#&gt; [1] "572/703"</span></span>
<span><span class="co">#&gt; [1] "573/703"</span></span>
<span><span class="co">#&gt; [1] "574/703"</span></span>
<span><span class="co">#&gt; [1] "575/703"</span></span>
<span><span class="co">#&gt; [1] "576/703"</span></span>
<span><span class="co">#&gt; [1] "577/703"</span></span>
<span><span class="co">#&gt; [1] "578/703"</span></span>
<span><span class="co">#&gt; [1] "579/703"</span></span>
<span><span class="co">#&gt; [1] "580/703"</span></span>
<span><span class="co">#&gt; [1] "581/703"</span></span>
<span><span class="co">#&gt; [1] "582/703"</span></span>
<span><span class="co">#&gt; [1] "583/703"</span></span>
<span><span class="co">#&gt; [1] "584/703"</span></span>
<span><span class="co">#&gt; [1] "585/703"</span></span>
<span><span class="co">#&gt; [1] "586/703"</span></span>
<span><span class="co">#&gt; [1] "587/703"</span></span>
<span><span class="co">#&gt; [1] "588/703"</span></span>
<span><span class="co">#&gt; [1] "589/703"</span></span>
<span><span class="co">#&gt; [1] "590/703"</span></span>
<span><span class="co">#&gt; [1] "591/703"</span></span>
<span><span class="co">#&gt; [1] "592/703"</span></span>
<span><span class="co">#&gt; [1] "593/703"</span></span>
<span><span class="co">#&gt; [1] "594/703"</span></span>
<span><span class="co">#&gt; [1] "595/703"</span></span>
<span><span class="co">#&gt; [1] "596/703"</span></span>
<span><span class="co">#&gt; [1] "597/703"</span></span>
<span><span class="co">#&gt; [1] "598/703"</span></span>
<span><span class="co">#&gt; [1] "599/703"</span></span>
<span><span class="co">#&gt; [1] "600/703"</span></span>
<span><span class="co">#&gt; [1] "601/703"</span></span>
<span><span class="co">#&gt; [1] "602/703"</span></span>
<span><span class="co">#&gt; [1] "603/703"</span></span>
<span><span class="co">#&gt; [1] "604/703"</span></span>
<span><span class="co">#&gt; [1] "605/703"</span></span>
<span><span class="co">#&gt; [1] "606/703"</span></span>
<span><span class="co">#&gt; [1] "607/703"</span></span>
<span><span class="co">#&gt; [1] "608/703"</span></span>
<span><span class="co">#&gt; [1] "609/703"</span></span>
<span><span class="co">#&gt; [1] "610/703"</span></span>
<span><span class="co">#&gt; [1] "611/703"</span></span>
<span><span class="co">#&gt; [1] "612/703"</span></span>
<span><span class="co">#&gt; [1] "613/703"</span></span>
<span><span class="co">#&gt; [1] "614/703"</span></span>
<span><span class="co">#&gt; [1] "615/703"</span></span>
<span><span class="co">#&gt; [1] "616/703"</span></span>
<span><span class="co">#&gt; [1] "617/703"</span></span>
<span><span class="co">#&gt; [1] "618/703"</span></span>
<span><span class="co">#&gt; [1] "619/703"</span></span>
<span><span class="co">#&gt; [1] "620/703"</span></span>
<span><span class="co">#&gt; [1] "621/703"</span></span>
<span><span class="co">#&gt; [1] "622/703"</span></span>
<span><span class="co">#&gt; [1] "623/703"</span></span>
<span><span class="co">#&gt; [1] "624/703"</span></span>
<span><span class="co">#&gt; [1] "625/703"</span></span>
<span><span class="co">#&gt; [1] "626/703"</span></span>
<span><span class="co">#&gt; [1] "627/703"</span></span>
<span><span class="co">#&gt; [1] "628/703"</span></span>
<span><span class="co">#&gt; [1] "629/703"</span></span>
<span><span class="co">#&gt; [1] "630/703"</span></span>
<span><span class="co">#&gt; [1] "631/703"</span></span>
<span><span class="co">#&gt; [1] "632/703"</span></span>
<span><span class="co">#&gt; [1] "633/703"</span></span>
<span><span class="co">#&gt; [1] "634/703"</span></span>
<span><span class="co">#&gt; [1] "635/703"</span></span>
<span><span class="co">#&gt; [1] "636/703"</span></span>
<span><span class="co">#&gt; [1] "637/703"</span></span>
<span><span class="co">#&gt; [1] "638/703"</span></span>
<span><span class="co">#&gt; [1] "639/703"</span></span>
<span><span class="co">#&gt; [1] "640/703"</span></span>
<span><span class="co">#&gt; [1] "641/703"</span></span>
<span><span class="co">#&gt; [1] "642/703"</span></span>
<span><span class="co">#&gt; [1] "643/703"</span></span>
<span><span class="co">#&gt; [1] "644/703"</span></span>
<span><span class="co">#&gt; [1] "645/703"</span></span>
<span><span class="co">#&gt; [1] "646/703"</span></span>
<span><span class="co">#&gt; [1] "647/703"</span></span>
<span><span class="co">#&gt; [1] "648/703"</span></span>
<span><span class="co">#&gt; [1] "649/703"</span></span>
<span><span class="co">#&gt; [1] "650/703"</span></span>
<span><span class="co">#&gt; [1] "651/703"</span></span>
<span><span class="co">#&gt; [1] "652/703"</span></span>
<span><span class="co">#&gt; [1] "653/703"</span></span>
<span><span class="co">#&gt; [1] "654/703"</span></span>
<span><span class="co">#&gt; [1] "655/703"</span></span>
<span><span class="co">#&gt; [1] "656/703"</span></span>
<span><span class="co">#&gt; [1] "657/703"</span></span>
<span><span class="co">#&gt; [1] "658/703"</span></span>
<span><span class="co">#&gt; [1] "659/703"</span></span>
<span><span class="co">#&gt; [1] "660/703"</span></span>
<span><span class="co">#&gt; [1] "661/703"</span></span>
<span><span class="co">#&gt; [1] "662/703"</span></span>
<span><span class="co">#&gt; [1] "663/703"</span></span>
<span><span class="co">#&gt; [1] "664/703"</span></span>
<span><span class="co">#&gt; [1] "665/703"</span></span>
<span><span class="co">#&gt; [1] "666/703"</span></span>
<span><span class="co">#&gt; [1] "667/703"</span></span>
<span><span class="co">#&gt; [1] "668/703"</span></span>
<span><span class="co">#&gt; [1] "669/703"</span></span>
<span><span class="co">#&gt; [1] "670/703"</span></span>
<span><span class="co">#&gt; [1] "671/703"</span></span>
<span><span class="co">#&gt; [1] "672/703"</span></span>
<span><span class="co">#&gt; [1] "673/703"</span></span>
<span><span class="co">#&gt; [1] "674/703"</span></span>
<span><span class="co">#&gt; [1] "675/703"</span></span>
<span><span class="co">#&gt; [1] "676/703"</span></span>
<span><span class="co">#&gt; [1] "677/703"</span></span>
<span><span class="co">#&gt; [1] "678/703"</span></span>
<span><span class="co">#&gt; [1] "679/703"</span></span>
<span><span class="co">#&gt; [1] "680/703"</span></span>
<span><span class="co">#&gt; [1] "681/703"</span></span>
<span><span class="co">#&gt; [1] "682/703"</span></span>
<span><span class="co">#&gt; [1] "683/703"</span></span>
<span><span class="co">#&gt; [1] "684/703"</span></span>
<span><span class="co">#&gt; [1] "685/703"</span></span>
<span><span class="co">#&gt; [1] "686/703"</span></span>
<span><span class="co">#&gt; [1] "687/703"</span></span>
<span><span class="co">#&gt; [1] "688/703"</span></span>
<span><span class="co">#&gt; [1] "689/703"</span></span>
<span><span class="co">#&gt; [1] "690/703"</span></span>
<span><span class="co">#&gt; [1] "691/703"</span></span>
<span><span class="co">#&gt; [1] "692/703"</span></span>
<span><span class="co">#&gt; [1] "693/703"</span></span>
<span><span class="co">#&gt; [1] "694/703"</span></span>
<span><span class="co">#&gt; [1] "695/703"</span></span>
<span><span class="co">#&gt; [1] "696/703"</span></span>
<span><span class="co">#&gt; [1] "697/703"</span></span>
<span><span class="co">#&gt; [1] "698/703"</span></span>
<span><span class="co">#&gt; [1] "699/703"</span></span>
<span><span class="co">#&gt; [1] "700/703"</span></span>
<span><span class="co">#&gt; [1] "701/703"</span></span>
<span><span class="co">#&gt; [1] "702/703"</span></span>
<span><span class="co">#&gt; [1] "703/703"</span></span></code></pre></div>
<p>Now that we have our distance matrices prepared, we can convert them
to kernel matrices and input them in our kernel machine regression
framework. We start by filling in the lower triangular portion of the
distance matrix (since we only filled in the upper half above). We then
convert it to a kernel matrix using a Gower centered kernel with the
function <code><a href="https://rdrr.io/pkg/MiRKAT/man/D2K.html" class="external-link">MiRKAT::D2K</a></code> function. Since we have two kernel
matrices, we consider a sequence of linear combinations of the two in
our test. We start by testing for an association with just the kernel
matrix based on connected components
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\omega=0</annotation></semantics></math>
in the code), based on a 50-50 even contribution from both kernel
matrices
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\omega=0.5</annotation></semantics></math>),
and just the kernel matrix based on loops
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\omega=1</annotation></semantics></math>).</p>
<p>For our first analytical goal, we test for an association with
overall survival. Below, we demonstrate how to extract the survival
times, censoring indicator, and age of each patient, which we adjust for
in our test.</p>
<p>The resulting kernel association testing p-value is printed below. We
observed a significant association in the topological structures among
immune cells and overall survival.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert the distance matrices to symmetric matrices</span></span>
<span><span class="va">dist.mat.deg0</span> <span class="op">&lt;-</span> <span class="va">dist.mat.deg0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span></span>
<span><span class="va">dist.mat.deg1</span> <span class="op">&lt;-</span> <span class="va">dist.mat.deg1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dist.mat.deg1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Construct kernel (similarity) matrix</span></span>
<span><span class="va">K.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dim0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MiRKAT/man/D2K.html" class="external-link">D2K</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span>, dim1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MiRKAT/man/D2K.html" class="external-link">D2K</a></span><span class="op">(</span><span class="va">dist.mat.deg1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set a list of weights</span></span>
<span><span class="va">omega.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save just the immune cells</span></span>
<span><span class="va">tnbc.immune</span> <span class="op">&lt;-</span> <span class="va">tnbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Group</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Subset the clinical data</span></span>
<span><span class="va">tnbc.immune.clin.only</span> <span class="op">&lt;-</span> <span class="va">tnbc.immune</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SampleID"</span>, <span class="st">"Survival_days_capped*"</span>, <span class="st">"Censored"</span>, <span class="st">"AGE_AT_DX"</span>, <span class="st">"Class"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert the survival times, censor indicator, and age vectors to numeric</span></span>
<span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">`Survival_days_capped*`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">`Survival_days_capped*`</span><span class="op">)</span></span>
<span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Censored</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Censored</span><span class="op">)</span></span>
<span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">AGE_AT_DX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">AGE_AT_DX</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict survival using Davies method</span></span>
<span><span class="va">survival.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TopKAT.html">TopKAT</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">`Survival_days_capped*`</span>,</span>
<span>                          X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">AGE_AT_DX</span><span class="op">)</span>,</span>
<span>                          cens <span class="op">=</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Censored</span>,</span>
<span>                          K.list <span class="op">=</span> <span class="va">K.list</span>,</span>
<span>                          omega.list <span class="op">=</span> <span class="va">omega.list</span>,</span>
<span>                          outcome.type <span class="op">=</span> <span class="st">"survival"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in MiRKAT::MiRKATS(obstime = y, delta = cens, X = X, Ks = K.aggregate, : Permutation p-values are recommendeded when n</span></span>
<span><span class="co">#&gt; &lt;= 50.</span></span>
<span></span>
<span><span class="va">survival.pred</span><span class="op">$</span><span class="va">overall.pval</span></span>
<span><span class="co">#&gt; [1] 0.0118498</span></span></code></pre></div>
<p>The second analytical goal is to compare the topological structures
between mixed, compartmentalized, and cold samples. For this, we use the
kernel matrices calculated above and do pairwise comparisons between
mixed and compartmentalized, mixed and cold, and compartmentalized and
cold samples. For each comparison, we treat category membership as a
binary outcome in our kernel test.</p>
<p>The code below shows how we subset the kernel matrix and the outcomes
to just samples within each class considered in the comparison. We print
out the resulting p-values, which all show significant differences in
the topological structure between biopsy classes.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, do pairwise comparisons of each group --</span></span>
<span></span>
<span><span class="co"># 0/1</span></span>
<span><span class="va">dist.mat.deg0.0vs1</span> <span class="op">&lt;-</span> <span class="va">dist.mat.deg0</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span><span class="va">dist.mat.deg1.0vs1</span> <span class="op">&lt;-</span> <span class="va">dist.mat.deg1</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span><span class="co"># Check ordering</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg0.0vs1</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg1.0vs1</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg0.0vs1</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg1.0vs1</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Construct kernel (similarity) matrix</span></span>
<span><span class="va">K.list.01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dim0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MiRKAT/man/D2K.html" class="external-link">D2K</a></span><span class="op">(</span><span class="va">dist.mat.deg0.0vs1</span><span class="op">)</span>, dim1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MiRKAT/man/D2K.html" class="external-link">D2K</a></span><span class="op">(</span><span class="va">dist.mat.deg1.0vs1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set the outcome</span></span>
<span><span class="va">class01</span> <span class="op">&lt;-</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span></span>
<span><span class="va">class01</span> <span class="op">&lt;-</span> <span class="va">class01</span><span class="op">[</span><span class="va">class01</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Predict class</span></span>
<span><span class="va">class01.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TopKAT.html">TopKAT</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">class01</span>,</span>
<span>                         K.list <span class="op">=</span> <span class="va">K.list.01</span>,</span>
<span>                         omega.list <span class="op">=</span> <span class="va">omega.list</span>,</span>
<span>                         outcome.type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in MiRKAT_binary(y, X = X, Ks = Ks, method = method, omnibus = omnibus, : For binary outcome and n &lt; 50, p-value using</span></span>
<span><span class="co">#&gt; davies method can be inaccurate at tails, permutation is recommended.</span></span>
<span></span>
<span><span class="va">class01.pred</span><span class="op">$</span><span class="va">overall.pval</span></span>
<span><span class="co">#&gt; [1] 0.0004638182</span></span>
<span></span>
<span><span class="co"># 0/2</span></span>
<span><span class="va">dist.mat.deg0.0vs2</span> <span class="op">&lt;-</span> <span class="va">dist.mat.deg0</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span><span class="va">dist.mat.deg1.0vs2</span> <span class="op">&lt;-</span> <span class="va">dist.mat.deg1</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span><span class="co"># Check ordering</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg0.0vs2</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg1.0vs2</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg0.0vs2</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg1.0vs2</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Construct kernel (similarity) matrix</span></span>
<span><span class="va">K.list.02</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dim0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MiRKAT/man/D2K.html" class="external-link">D2K</a></span><span class="op">(</span><span class="va">dist.mat.deg0.0vs2</span><span class="op">)</span>, dim1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MiRKAT/man/D2K.html" class="external-link">D2K</a></span><span class="op">(</span><span class="va">dist.mat.deg1.0vs2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set the outcome</span></span>
<span><span class="va">class02</span> <span class="op">&lt;-</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span></span>
<span><span class="va">class02</span> <span class="op">&lt;-</span> <span class="va">class02</span><span class="op">[</span><span class="va">class02</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">class02</span><span class="op">[</span><span class="va">class02</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Predict class</span></span>
<span><span class="va">class02.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TopKAT.html">TopKAT</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">class02</span>,</span>
<span>                         K.list <span class="op">=</span> <span class="va">K.list.02</span>,</span>
<span>                         omega.list <span class="op">=</span> <span class="va">omega.list</span>,</span>
<span>                         outcome.type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in MiRKAT_binary(y, X = X, Ks = Ks, method = method, omnibus = omnibus, : For binary outcome and n &lt; 50, p-value using</span></span>
<span><span class="co">#&gt; davies method can be inaccurate at tails, permutation is recommended.</span></span>
<span></span>
<span><span class="va">class02.pred</span><span class="op">$</span><span class="va">overall.pval</span></span>
<span><span class="co">#&gt; [1] 0.01118632</span></span>
<span></span>
<span><span class="co"># 1/2</span></span>
<span><span class="va">dist.mat.deg0.1vs2</span> <span class="op">&lt;-</span> <span class="va">dist.mat.deg0</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span><span class="va">dist.mat.deg1.1vs2</span> <span class="op">&lt;-</span> <span class="va">dist.mat.deg1</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span><span class="co"># Check ordering</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg0.1vs2</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dist.mat.deg1.1vs2</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg0.1vs2</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist.mat.deg1.1vs2</span><span class="op">)</span> <span class="op">==</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">SampleID</span><span class="op">[</span><span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># TRUE!</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Construct kernel (similarity) matrix</span></span>
<span><span class="va">K.list.12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dim0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MiRKAT/man/D2K.html" class="external-link">D2K</a></span><span class="op">(</span><span class="va">dist.mat.deg0.1vs2</span><span class="op">)</span>, dim1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MiRKAT/man/D2K.html" class="external-link">D2K</a></span><span class="op">(</span><span class="va">dist.mat.deg1.1vs2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set the outcome</span></span>
<span><span class="va">class12</span> <span class="op">&lt;-</span> <span class="va">tnbc.immune.clin.only</span><span class="op">$</span><span class="va">Class</span></span>
<span><span class="va">class12</span> <span class="op">&lt;-</span> <span class="va">class12</span><span class="op">[</span><span class="va">class12</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">class12</span><span class="op">[</span><span class="va">class12</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">class12</span><span class="op">[</span><span class="va">class12</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Predict class</span></span>
<span><span class="va">class12.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TopKAT.html">TopKAT</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">class12</span>,</span>
<span>                         K.list <span class="op">=</span> <span class="va">K.list.12</span>,</span>
<span>                         omega.list <span class="op">=</span> <span class="va">omega.list</span>,</span>
<span>                         outcome.type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in MiRKAT_binary(y, X = X, Ks = Ks, method = method, omnibus = omnibus, : For binary outcome and n &lt; 50, p-value using</span></span>
<span><span class="co">#&gt; davies method can be inaccurate at tails, permutation is recommended.</span></span>
<span></span>
<span><span class="va">class12.pred</span><span class="op">$</span><span class="va">overall.pval</span></span>
<span><span class="co">#&gt; [1] 5.080601e-05</span></span></code></pre></div>
<div class="section level3">
<h3 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-keren2018structured" class="csl-entry">
Keren, Leeat, Marc Bosse, Diana Marquez, Roshan Angoshtari, Samir Jain,
Sushama Varma, Soo-Ryum Yang, et al. 2018. <span>“A Structured
Tumor-Immune Microenvironment in Triple Negative Breast Cancer Revealed
by Multiplexed Ion Beam Imaging.”</span> <em>Cell</em> 174 (6): 1373–87.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sarah Samorodnitsky.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
