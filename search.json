[{"path":"https://sarahsamorodnitsky.github.io/TopKAT/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 TopKAT authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Sarah Samorodnitsky. Author, maintainer.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Samorodnitsky S (2024). TopKAT: Topological Kernel Association Test (TopKAT). R package version 0.0.0.9000, https://sarahsamorodnitsky.github.io/TopKAT/.","code":"@Manual{,   title = {TopKAT: Topological Kernel Association Test (TopKAT)},   author = {Sarah Samorodnitsky},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://sarahsamorodnitsky.github.io/TopKAT/}, }"},{"path":[]},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Topological Kernel Association Test (TopKAT)","text":"TopKAT global test association topological (geometric) structure cells cell-level imaging data. goal TopKAT package provide software run test post-hoc analyses results.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Topological Kernel Association Test (TopKAT)","text":"can install development version TopKAT Github via: TopKAT relies several dependencies: MiRKAT, RcppAlgos, TDAstats, dplyr, ggplot2, ggtda, reshape2, tidyr, viridis, igraph, magrittr. underlying engine running persistent homology TDAstats. ggtda, facilitates visualization filtration process persistence diagrams available Github.","code":"# First, install devtools if (!require(\"devtools\", quietly = TRUE)) {   install.packages(\"devtools\") }  # Install from Github devtools::install_github(\"sarahsamorodnitsky/TopKAT\")"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/index.html","id":"vignettes","dir":"","previous_headings":"","what":"Vignettes","title":"Topological Kernel Association Test (TopKAT)","text":"Example usage TopKAT analyze data provided two vignetes: Getting Started: illustrates application TopKAT simulated dataset containing contrived shapes. Simulated Tissue: illustrates application TopKAT dataset simulated using scSpatialSIM package.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/TopKAT.html","id":null,"dir":"Reference","previous_headings":"","what":"Topological Kernel Association Test (TopKAT) — TopKAT","title":"Topological Kernel Association Test (TopKAT) — TopKAT","text":"Perform global test association geometric (topological) structures spatially-resolved images cells continuous, binary, survival outcomes.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/TopKAT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Topological Kernel Association Test (TopKAT) — TopKAT","text":"","code":"TopKAT(   y,   X = NULL,   cens = NULL,   K.list,   omega.list,   outcome.type = \"continuous\",   method = \"davies\",   omnibus = \"cauchy\",   perm = FALSE,   nperm = 999 )"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/TopKAT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Topological Kernel Association Test (TopKAT) — TopKAT","text":"y Vector outcomes. Must numeric. continuous survival data, numeric vector. binary outcome, must consist 0s 1s. X Matrix covariates adjust . May left NULL. cens Vector event indicators survival outcome. 1 indicates sample experienced event, 0 otherwise. using survival outcome, leave NULL. K.list List 2 kernel matrices corresponding similarities among connected components among loops. May provide 1 kernel matrix interested specific homology. omega.list Vector weights create different combinations kernel matrices. suggested options: c(0, 1) TopKAT combine p-values test associating connected components y loops y separately. c(0, 0.5, 1) combine p-values across just connected components, even split connected components loops, just loops. outcome.type kind outcome y? Options include \"continuous\", \"binary\", \"survival\". method Specifies kernel p-value calculated. Options include \"davies\" analytical p-value calculation \"permutation\". continuous binary outcomes. omnibus providing multiple kernel matrices, specify p-values combined. Defaults \"cauchy\" Cauchy combination test. perm Required survival outcomes. Specifies permutations used. Default FALSE Davies method used. nperm using permutations, many permutations used?","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/TopKAT.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Topological Kernel Association Test (TopKAT) — TopKAT","text":"Returns list following objects: overall.pval: overall p-value describing association similarities topological structures clinical outcomes, p.vals: vector individual p-values weight omega.list, y: outcome provided, X: covariates provided, omega.list: vector weights provided, outcome.type: outcome type specified","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/TopKAT.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Topological Kernel Association Test (TopKAT) — TopKAT","text":"","code":"# First, construct the similarity matrix simmat <- rips_similarity_matrix(data1.df, max.threshold = 100, print.progress = TRUE) #> [1] \"Rips diagram: 1\" #> [1] \"Rips diagram: 2\" #> [1] \"Rips diagram: 3\" #> [1] \"Rips diagram: 4\" #> [1] \"Rips diagram: 5\" #> [1] \"Rips diagram: 6\" #> [1] \"Rips diagram: 7\" #> [1] \"Rips diagram: 8\" #> [1] \"Rips diagram: 9\" #> [1] \"Rips diagram: 10\" #> [1] \"Rips diagram: 11\" #> [1] \"Rips diagram: 12\" #> [1] \"Rips diagram: 13\" #> [1] \"Rips diagram: 14\" #> [1] \"Rips diagram: 15\" #> [1] \"Rips diagram: 16\" #> [1] \"Rips diagram: 17\" #> [1] \"Rips diagram: 18\" #> [1] \"Rips diagram: 19\" #> [1] \"Rips diagram: 20\" #> [1] \"Rips diagram: 21\" #> [1] \"Rips diagram: 22\" #> [1] \"Rips diagram: 23\" #> [1] \"Rips diagram: 24\" #> [1] \"Rips diagram: 25\" #> [1] \"Rips diagram: 26\" #> [1] \"Rips diagram: 27\" #> [1] \"Rips diagram: 28\" #> [1] \"Rips diagram: 29\" #> [1] \"Rips diagram: 30\" #> [1] \"Rips diagram: 31\" #> [1] \"Rips diagram: 32\" #> [1] \"Rips diagram: 33\" #> [1] \"Rips diagram: 34\" #> [1] \"Rips diagram: 35\" #> [1] \"Rips diagram: 36\" #> [1] \"Rips diagram: 37\" #> [1] \"Rips diagram: 38\" #> [1] \"Rips diagram: 39\" #> [1] \"Rips diagram: 40\" #> [1] \"Rips diagram: 41\" #> [1] \"Rips diagram: 42\" #> [1] \"Rips diagram: 43\" #> [1] \"Rips diagram: 44\" #> [1] \"Rips diagram: 45\" #> [1] \"Rips diagram: 46\" #> [1] \"Rips diagram: 47\" #> [1] \"Rips diagram: 48\" #> [1] \"Rips diagram: 49\" #> [1] \"Rips diagram: 50\" #> [1] \"Rips diagram: 51\" #> [1] \"Rips diagram: 52\" #> [1] \"Rips diagram: 53\" #> [1] \"Rips diagram: 54\" #> [1] \"Rips diagram: 55\" #> [1] \"Rips diagram: 56\" #> [1] \"Rips diagram: 57\" #> [1] \"Rips diagram: 58\" #> [1] \"Rips diagram: 59\" #> [1] \"Rips diagram: 60\" #> [1] \"Rips diagram: 61\" #> [1] \"Rips diagram: 62\" #> [1] \"Rips diagram: 63\" #> [1] \"Rips diagram: 64\" #> [1] \"Rips diagram: 65\" #> [1] \"Rips diagram: 66\" #> [1] \"Rips diagram: 67\" #> [1] \"Rips diagram: 68\" #> [1] \"Rips diagram: 69\" #> [1] \"Rips diagram: 70\" #> [1] \"Rips diagram: 71\" #> [1] \"Rips diagram: 72\" #> [1] \"Rips diagram: 73\" #> [1] \"Rips diagram: 74\" #> [1] \"Rips diagram: 75\" #> [1] \"Rips diagram: 76\" #> [1] \"Rips diagram: 77\" #> [1] \"Rips diagram: 78\" #> [1] \"Rips diagram: 79\" #> [1] \"Rips diagram: 80\" #> [1] \"Rips diagram: 81\" #> [1] \"Rips diagram: 82\" #> [1] \"Rips diagram: 83\" #> [1] \"Rips diagram: 84\" #> [1] \"Rips diagram: 85\" #> [1] \"Rips diagram: 86\" #> [1] \"Rips diagram: 87\" #> [1] \"Rips diagram: 88\" #> [1] \"Rips diagram: 89\" #> [1] \"Rips diagram: 90\" #> [1] \"Rips diagram: 91\" #> [1] \"Rips diagram: 92\" #> [1] \"Rips diagram: 93\" #> [1] \"Rips diagram: 94\" #> [1] \"Rips diagram: 95\" #> [1] \"Rips diagram: 96\" #> [1] \"Rips diagram: 97\" #> [1] \"Rips diagram: 98\" #> [1] \"Rips diagram: 99\" #> [1] \"Rips diagram: 100\"  # Then, run TopKAT res <- TopKAT(y = y,               cens = cens,               K.list = simmat$K.list,               omega.list = c(0, 0.5, 1),               outcome.type = \"survival\")  # Check result res$overall.pval #> [1] 3.443675e-05"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/cens.html","id":null,"dir":"Reference","previous_headings":"","what":"Event indicator vector cens — cens","title":"Event indicator vector cens — cens","text":"vector contains binary indicators reflecting whether sample event. vector equals 1, indicates corresponding patient event 0 otherwise.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/cens.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Event indicator vector cens — cens","text":"","code":"cens"},{"path":[]},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/cens.html","id":"cens","dir":"Reference","previous_headings":"","what":"cens","title":"Event indicator vector cens — cens","text":"vector length 100 event indicators.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/data1.df.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated data 1 — data1.df","title":"Simulated data 1 — data1.df","text":"dataset contains simulated data. images split two groups. first group simulated large squares. second group simulated loops. dataset contains 100 samples.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/data1.df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated data 1 — data1.df","text":"","code":"data1.df"},{"path":[]},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/data1.df.html","id":"data-df","dir":"Reference","previous_headings":"","what":"data1.df","title":"Simulated data 1 — data1.df","text":"data frame 29951 rows 4 columns: PID Patient ID id Image ID (matches Patient ID) x x-coordinate cell y y-coordinate cell","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/data2.df.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated data 2 — data2.df","title":"Simulated data 2 — data2.df","text":"dataset contains simulated data. images simulated using scSpatialSIM package represent different tissue structures. Specifically, used scSpatialSIM simulate two different tissues separated different images. dataset contains 100 samples.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/data2.df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated data 2 — data2.df","text":"","code":"data2.df"},{"path":[]},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/data2.df.html","id":"data-df","dir":"Reference","previous_headings":"","what":"data2.df","title":"Simulated data 2 — data2.df","text":"data frame 100481 rows 4 columns: PID Patient ID id Image ID (matches Patient ID) x x-coordinate cell y y-coordinate cell","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_connectivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate connectivity matrix — generate_connectivity","title":"Generate connectivity matrix — generate_connectivity","text":"Based radius lowest TopKAT p-value, compute connections matrix shows many edges cells type simplicial complex constructed based radius.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_connectivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate connectivity matrix — generate_connectivity","text":"","code":"generate_connectivity(images.df, threshold, type.column, unique.types)"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_connectivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate connectivity matrix — generate_connectivity","text":"images.df data.frame containing image information. See details. threshold Radius generate connectivity type.column name column images.df contains cell types unique.types Vector unique cell types type.column","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_connectivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate connectivity matrix — generate_connectivity","text":"Returns connectivity matrix dimension \\(n\\times n\\) \\(n\\) number cell types, .e. length unique.types","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_connectivity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate connectivity matrix — generate_connectivity","text":"images.df contain PID column indicating sample image corresponds . also contain columns x y indicating location cell. row images.df corresponds cell within image. See package vignettes example structure. function may take several minutes run require substantial amount memory. memory limit reached, consider running mem.maxVSize(vsize = x) specify x large value.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_connectivity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate connectivity matrix — generate_connectivity","text":"","code":"require(magrittr) #> Loading required package: magrittr conmat <- generate_connectivity(data1.df %>% dplyr::filter(PID == 1), threshold = 10,                                 type.column = \"type\", unique.types = unique(data1.df$type))"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_rips.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a list of persistence diagrams — generate_rips","title":"Generate a list of persistence diagrams — generate_rips","text":"Run Rips filtration image return list persistence diagrams. helper function scale_importance.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_rips.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a list of persistence diagrams — generate_rips","text":"","code":"generate_rips(images.df, max.threshold, print.progress = TRUE)"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_rips.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a list of persistence diagrams — generate_rips","text":"images.df data.frame containing image information. See details. max.threshold maximum radius circles Rips filtration print.progress Boolean indicating whether progress constructing Rips filtrations across images printed.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_rips.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a list of persistence diagrams — generate_rips","text":"Returns list persistence diagrams image.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/generate_rips.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a list of persistence diagrams — generate_rips","text":"","code":"# Generate a persistence diagram based on a Rips filtration for each image pd.list <- generate_rips(data1.df, 100) #> [1] \"Rips diagram: 1\" #> [1] \"Rips diagram: 2\" #> [1] \"Rips diagram: 3\" #> [1] \"Rips diagram: 4\" #> [1] \"Rips diagram: 5\" #> [1] \"Rips diagram: 6\" #> [1] \"Rips diagram: 7\" #> [1] \"Rips diagram: 8\" #> [1] \"Rips diagram: 9\" #> [1] \"Rips diagram: 10\" #> [1] \"Rips diagram: 11\" #> [1] \"Rips diagram: 12\" #> [1] \"Rips diagram: 13\" #> [1] \"Rips diagram: 14\" #> [1] \"Rips diagram: 15\" #> [1] \"Rips diagram: 16\" #> [1] \"Rips diagram: 17\" #> [1] \"Rips diagram: 18\" #> [1] \"Rips diagram: 19\" #> [1] \"Rips diagram: 20\" #> [1] \"Rips diagram: 21\" #> [1] \"Rips diagram: 22\" #> [1] \"Rips diagram: 23\" #> [1] \"Rips diagram: 24\" #> [1] \"Rips diagram: 25\" #> [1] \"Rips diagram: 26\" #> [1] \"Rips diagram: 27\" #> [1] \"Rips diagram: 28\" #> [1] \"Rips diagram: 29\" #> [1] \"Rips diagram: 30\" #> [1] \"Rips diagram: 31\" #> [1] \"Rips diagram: 32\" #> [1] \"Rips diagram: 33\" #> [1] \"Rips diagram: 34\" #> [1] \"Rips diagram: 35\" #> [1] \"Rips diagram: 36\" #> [1] \"Rips diagram: 37\" #> [1] \"Rips diagram: 38\" #> [1] \"Rips diagram: 39\" #> [1] \"Rips diagram: 40\" #> [1] \"Rips diagram: 41\" #> [1] \"Rips diagram: 42\" #> [1] \"Rips diagram: 43\" #> [1] \"Rips diagram: 44\" #> [1] \"Rips diagram: 45\" #> [1] \"Rips diagram: 46\" #> [1] \"Rips diagram: 47\" #> [1] \"Rips diagram: 48\" #> [1] \"Rips diagram: 49\" #> [1] \"Rips diagram: 50\" #> [1] \"Rips diagram: 51\" #> [1] \"Rips diagram: 52\" #> [1] \"Rips diagram: 53\" #> [1] \"Rips diagram: 54\" #> [1] \"Rips diagram: 55\" #> [1] \"Rips diagram: 56\" #> [1] \"Rips diagram: 57\" #> [1] \"Rips diagram: 58\" #> [1] \"Rips diagram: 59\" #> [1] \"Rips diagram: 60\" #> [1] \"Rips diagram: 61\" #> [1] \"Rips diagram: 62\" #> [1] \"Rips diagram: 63\" #> [1] \"Rips diagram: 64\" #> [1] \"Rips diagram: 65\" #> [1] \"Rips diagram: 66\" #> [1] \"Rips diagram: 67\" #> [1] \"Rips diagram: 68\" #> [1] \"Rips diagram: 69\" #> [1] \"Rips diagram: 70\" #> [1] \"Rips diagram: 71\" #> [1] \"Rips diagram: 72\" #> [1] \"Rips diagram: 73\" #> [1] \"Rips diagram: 74\" #> [1] \"Rips diagram: 75\" #> [1] \"Rips diagram: 76\" #> [1] \"Rips diagram: 77\" #> [1] \"Rips diagram: 78\" #> [1] \"Rips diagram: 79\" #> [1] \"Rips diagram: 80\" #> [1] \"Rips diagram: 81\" #> [1] \"Rips diagram: 82\" #> [1] \"Rips diagram: 83\" #> [1] \"Rips diagram: 84\" #> [1] \"Rips diagram: 85\" #> [1] \"Rips diagram: 86\" #> [1] \"Rips diagram: 87\" #> [1] \"Rips diagram: 88\" #> [1] \"Rips diagram: 89\" #> [1] \"Rips diagram: 90\" #> [1] \"Rips diagram: 91\" #> [1] \"Rips diagram: 92\" #> [1] \"Rips diagram: 93\" #> [1] \"Rips diagram: 94\" #> [1] \"Rips diagram: 95\" #> [1] \"Rips diagram: 96\" #> [1] \"Rips diagram: 97\" #> [1] \"Rips diagram: 98\" #> [1] \"Rips diagram: 99\" #> [1] \"Rips diagram: 100\""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_cell_connections.html","id":null,"dir":"Reference","previous_headings":"","what":"Heatmap of cell-cell connections — plot_cell_connections","title":"Heatmap of cell-cell connections — plot_cell_connections","text":"Visualize connectivity matrix produced generate_connectivity","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_cell_connections.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Heatmap of cell-cell connections — plot_cell_connections","text":"","code":"plot_cell_connections(image, threshold, title, type.column, unique.types)"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_cell_connections.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Heatmap of cell-cell connections — plot_cell_connections","text":"image data.frame containing image information. threshold Radius plot, usually threshold generated scale_importance title Plot title type.column name column images.df contains cell types unique.types Vector unique cell types type.column","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_cell_connections.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Heatmap of cell-cell connections — plot_cell_connections","text":"Returns ggplot heatmap cell-cell connections.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_cell_connections.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Heatmap of cell-cell connections — plot_cell_connections","text":"","code":"require(magrittr) plot_cell_connections(    image = data1.df %>% dplyr::filter(PID == 1),    threshold = 10,    title = \"\",    type.column = \"type\",    unique.types = unique(data1.df$type) )"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_cells_with_scale.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot cells with radius value — plot_cells_with_scale","title":"Plot cells with radius value — plot_cells_with_scale","text":"function plots simplicial complex cells points given radius value connecting .","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_cells_with_scale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot cells with radius value — plot_cells_with_scale","text":"","code":"plot_cells_with_scale(image, threshold, title)"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_cells_with_scale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot cells with radius value — plot_cells_with_scale","text":"image data.frame containing cell information single image. threshold Radius plot title Title plot","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_cells_with_scale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot cells with radius value — plot_cells_with_scale","text":"Returns ggplot scatterplot data edges length threshold connecting cells.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_cells_with_scale.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot cells with radius value — plot_cells_with_scale","text":"","code":"require(magrittr) plot_cells_with_scale(   image = data1.df %>% dplyr::filter(PID == 51),   threshold = 10,   title = \"Example Plot of Cells\" )"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_persistence.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot persistence diagrams — plot_persistence","title":"Plot persistence diagrams — plot_persistence","text":"Plot persistence diagrams","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_persistence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot persistence diagrams — plot_persistence","text":"","code":"plot_persistence(PD, title, dims = c(100, 100))"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_persistence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot persistence diagrams — plot_persistence","text":"PD Persistence diagram given image title Title output figure dims Dimensions output figure","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_persistence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot persistence diagrams — plot_persistence","text":"Plot illustrating birth death scales homology","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/plot_persistence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot persistence diagrams — plot_persistence","text":"","code":"require(magrittr) PD <- TDAstats::calculate_homology(        data2.df %>% dplyr::filter(PID == 1) %>% dplyr::select(x,y),        dim = 1,        threshold = 10) plot_persistence(PD = PD, title = \"Example Persistence Diagram\", dims = c(10, 10))"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/rips_similarity_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a similarity matrix based on the Rips filtration — rips_similarity_matrix","title":"Calculate a similarity matrix based on the Rips filtration — rips_similarity_matrix","text":"Given input data, computes Rips filtration persistence diagram image. constructs pairwise similarity matrix homology group (connected components loops) based resulting persistence diagrams.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/rips_similarity_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a similarity matrix based on the Rips filtration — rips_similarity_matrix","text":"","code":"rips_similarity_matrix(images.df, max.threshold, print.progress = TRUE)"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/rips_similarity_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a similarity matrix based on the Rips filtration — rips_similarity_matrix","text":"images.df data.frame containing image information. See details. max.threshold maximum radius circles Rips filtration print.progress Boolean indicating whether progress constructing Rips filtrations across images printed.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/rips_similarity_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a similarity matrix based on the Rips filtration — rips_similarity_matrix","text":"Returns list similarity (kernel) matrices list resulting persistence diagrams image.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/rips_similarity_matrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate a similarity matrix based on the Rips filtration — rips_similarity_matrix","text":"images.df contain PID column indicating sample image corresponds . also contain columns x y indicating location cell. row images.df corresponds cell within image. See package vignettes example structure. choose max.threshold, reasonable first choice select maximum possible radius cover cells image. maximum width largest image, example. function run first step TopKAT analysis. , resulting kernel matrices may fed TopKAT function.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/rips_similarity_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate a similarity matrix based on the Rips filtration — rips_similarity_matrix","text":"","code":"# Construct a Rips filtration for each simulated image simmat <- rips_similarity_matrix(data1.df, max.threshold = 100, print.progress = TRUE) #> [1] \"Rips diagram: 1\" #> [1] \"Rips diagram: 2\" #> [1] \"Rips diagram: 3\" #> [1] \"Rips diagram: 4\" #> [1] \"Rips diagram: 5\" #> [1] \"Rips diagram: 6\" #> [1] \"Rips diagram: 7\" #> [1] \"Rips diagram: 8\" #> [1] \"Rips diagram: 9\" #> [1] \"Rips diagram: 10\" #> [1] \"Rips diagram: 11\" #> [1] \"Rips diagram: 12\" #> [1] \"Rips diagram: 13\" #> [1] \"Rips diagram: 14\" #> [1] \"Rips diagram: 15\" #> [1] \"Rips diagram: 16\" #> [1] \"Rips diagram: 17\" #> [1] \"Rips diagram: 18\" #> [1] \"Rips diagram: 19\" #> [1] \"Rips diagram: 20\" #> [1] \"Rips diagram: 21\" #> [1] \"Rips diagram: 22\" #> [1] \"Rips diagram: 23\" #> [1] \"Rips diagram: 24\" #> [1] \"Rips diagram: 25\" #> [1] \"Rips diagram: 26\" #> [1] \"Rips diagram: 27\" #> [1] \"Rips diagram: 28\" #> [1] \"Rips diagram: 29\" #> [1] \"Rips diagram: 30\" #> [1] \"Rips diagram: 31\" #> [1] \"Rips diagram: 32\" #> [1] \"Rips diagram: 33\" #> [1] \"Rips diagram: 34\" #> [1] \"Rips diagram: 35\" #> [1] \"Rips diagram: 36\" #> [1] \"Rips diagram: 37\" #> [1] \"Rips diagram: 38\" #> [1] \"Rips diagram: 39\" #> [1] \"Rips diagram: 40\" #> [1] \"Rips diagram: 41\" #> [1] \"Rips diagram: 42\" #> [1] \"Rips diagram: 43\" #> [1] \"Rips diagram: 44\" #> [1] \"Rips diagram: 45\" #> [1] \"Rips diagram: 46\" #> [1] \"Rips diagram: 47\" #> [1] \"Rips diagram: 48\" #> [1] \"Rips diagram: 49\" #> [1] \"Rips diagram: 50\" #> [1] \"Rips diagram: 51\" #> [1] \"Rips diagram: 52\" #> [1] \"Rips diagram: 53\" #> [1] \"Rips diagram: 54\" #> [1] \"Rips diagram: 55\" #> [1] \"Rips diagram: 56\" #> [1] \"Rips diagram: 57\" #> [1] \"Rips diagram: 58\" #> [1] \"Rips diagram: 59\" #> [1] \"Rips diagram: 60\" #> [1] \"Rips diagram: 61\" #> [1] \"Rips diagram: 62\" #> [1] \"Rips diagram: 63\" #> [1] \"Rips diagram: 64\" #> [1] \"Rips diagram: 65\" #> [1] \"Rips diagram: 66\" #> [1] \"Rips diagram: 67\" #> [1] \"Rips diagram: 68\" #> [1] \"Rips diagram: 69\" #> [1] \"Rips diagram: 70\" #> [1] \"Rips diagram: 71\" #> [1] \"Rips diagram: 72\" #> [1] \"Rips diagram: 73\" #> [1] \"Rips diagram: 74\" #> [1] \"Rips diagram: 75\" #> [1] \"Rips diagram: 76\" #> [1] \"Rips diagram: 77\" #> [1] \"Rips diagram: 78\" #> [1] \"Rips diagram: 79\" #> [1] \"Rips diagram: 80\" #> [1] \"Rips diagram: 81\" #> [1] \"Rips diagram: 82\" #> [1] \"Rips diagram: 83\" #> [1] \"Rips diagram: 84\" #> [1] \"Rips diagram: 85\" #> [1] \"Rips diagram: 86\" #> [1] \"Rips diagram: 87\" #> [1] \"Rips diagram: 88\" #> [1] \"Rips diagram: 89\" #> [1] \"Rips diagram: 90\" #> [1] \"Rips diagram: 91\" #> [1] \"Rips diagram: 92\" #> [1] \"Rips diagram: 93\" #> [1] \"Rips diagram: 94\" #> [1] \"Rips diagram: 95\" #> [1] \"Rips diagram: 96\" #> [1] \"Rips diagram: 97\" #> [1] \"Rips diagram: 98\" #> [1] \"Rips diagram: 99\" #> [1] \"Rips diagram: 100\""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/scale_importance.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantifying the importance of various scale parameters — scale_importance","title":"Quantifying the importance of various scale parameters — scale_importance","text":"Identify radii important characterizing association topological structure image outcomes.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/scale_importance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantifying the importance of various scale parameters — scale_importance","text":"","code":"scale_importance(   pd.list,   y,   X = NULL,   cens = NULL,   omega.list,   threshold,   PIDs,   outcome.type = \"continuous\",   method = \"davies\",   omnibus = \"cauchy\",   perm = FALSE,   nperm = 999,   n.thresh = 50,   print.progress = FALSE )"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/scale_importance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantifying the importance of various scale parameters — scale_importance","text":"pd.list List persistence diagrams y Outcome vector X Covariates adjust , desired. May left NULL. cens Censoring vector survival outcomes. May left NULL. omega.list Vector weights combine kernel matrices threshold Maximum radius Rips filtration PIDs Vector patient IDs outcome.type Outcome type, options include \"continuous\", \"binary\", \"survival\" method Specifies kernel p-value calculated. Options include \"davies\" analytical p-value calculation \"permutation\". continuous binary outcomes. omnibus providing multiple kernel matrices, specify p-values combined. Defaults \"cauchy\" Cauchy combination test. perm Required survival outcomes. Specifies permutations used. Default FALSE Davies method used. nperm using permutations, many permutations used? n.thresh many maximum radii considered? print.progress Boolean, progress printed throughout analysis?","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/scale_importance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantifying the importance of various scale parameters — scale_importance","text":"Returns list following elements: min.thresh radius value lowest TopKAT p-value obtained pvals vector TopKAT p-values radius value threshold.seq vector maximum radii considered","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/scale_importance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantifying the importance of various scale parameters — scale_importance","text":"arguments method, omnibus, perm, nperm match used TopKAT analysis.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/scale_importance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantifying the importance of various scale parameters — scale_importance","text":"","code":"# Generate a persistence diagram based on a Rips filtration for each image pd.list <- generate_rips(data1.df, 100) #> [1] \"Rips diagram: 1\" #> [1] \"Rips diagram: 2\" #> [1] \"Rips diagram: 3\" #> [1] \"Rips diagram: 4\" #> [1] \"Rips diagram: 5\" #> [1] \"Rips diagram: 6\" #> [1] \"Rips diagram: 7\" #> [1] \"Rips diagram: 8\" #> [1] \"Rips diagram: 9\" #> [1] \"Rips diagram: 10\" #> [1] \"Rips diagram: 11\" #> [1] \"Rips diagram: 12\" #> [1] \"Rips diagram: 13\" #> [1] \"Rips diagram: 14\" #> [1] \"Rips diagram: 15\" #> [1] \"Rips diagram: 16\" #> [1] \"Rips diagram: 17\" #> [1] \"Rips diagram: 18\" #> [1] \"Rips diagram: 19\" #> [1] \"Rips diagram: 20\" #> [1] \"Rips diagram: 21\" #> [1] \"Rips diagram: 22\" #> [1] \"Rips diagram: 23\" #> [1] \"Rips diagram: 24\" #> [1] \"Rips diagram: 25\" #> [1] \"Rips diagram: 26\" #> [1] \"Rips diagram: 27\" #> [1] \"Rips diagram: 28\" #> [1] \"Rips diagram: 29\" #> [1] \"Rips diagram: 30\" #> [1] \"Rips diagram: 31\" #> [1] \"Rips diagram: 32\" #> [1] \"Rips diagram: 33\" #> [1] \"Rips diagram: 34\" #> [1] \"Rips diagram: 35\" #> [1] \"Rips diagram: 36\" #> [1] \"Rips diagram: 37\" #> [1] \"Rips diagram: 38\" #> [1] \"Rips diagram: 39\" #> [1] \"Rips diagram: 40\" #> [1] \"Rips diagram: 41\" #> [1] \"Rips diagram: 42\" #> [1] \"Rips diagram: 43\" #> [1] \"Rips diagram: 44\" #> [1] \"Rips diagram: 45\" #> [1] \"Rips diagram: 46\" #> [1] \"Rips diagram: 47\" #> [1] \"Rips diagram: 48\" #> [1] \"Rips diagram: 49\" #> [1] \"Rips diagram: 50\" #> [1] \"Rips diagram: 51\" #> [1] \"Rips diagram: 52\" #> [1] \"Rips diagram: 53\" #> [1] \"Rips diagram: 54\" #> [1] \"Rips diagram: 55\" #> [1] \"Rips diagram: 56\" #> [1] \"Rips diagram: 57\" #> [1] \"Rips diagram: 58\" #> [1] \"Rips diagram: 59\" #> [1] \"Rips diagram: 60\" #> [1] \"Rips diagram: 61\" #> [1] \"Rips diagram: 62\" #> [1] \"Rips diagram: 63\" #> [1] \"Rips diagram: 64\" #> [1] \"Rips diagram: 65\" #> [1] \"Rips diagram: 66\" #> [1] \"Rips diagram: 67\" #> [1] \"Rips diagram: 68\" #> [1] \"Rips diagram: 69\" #> [1] \"Rips diagram: 70\" #> [1] \"Rips diagram: 71\" #> [1] \"Rips diagram: 72\" #> [1] \"Rips diagram: 73\" #> [1] \"Rips diagram: 74\" #> [1] \"Rips diagram: 75\" #> [1] \"Rips diagram: 76\" #> [1] \"Rips diagram: 77\" #> [1] \"Rips diagram: 78\" #> [1] \"Rips diagram: 79\" #> [1] \"Rips diagram: 80\" #> [1] \"Rips diagram: 81\" #> [1] \"Rips diagram: 82\" #> [1] \"Rips diagram: 83\" #> [1] \"Rips diagram: 84\" #> [1] \"Rips diagram: 85\" #> [1] \"Rips diagram: 86\" #> [1] \"Rips diagram: 87\" #> [1] \"Rips diagram: 88\" #> [1] \"Rips diagram: 89\" #> [1] \"Rips diagram: 90\" #> [1] \"Rips diagram: 91\" #> [1] \"Rips diagram: 92\" #> [1] \"Rips diagram: 93\" #> [1] \"Rips diagram: 94\" #> [1] \"Rips diagram: 95\" #> [1] \"Rips diagram: 96\" #> [1] \"Rips diagram: 97\" #> [1] \"Rips diagram: 98\" #> [1] \"Rips diagram: 99\" #> [1] \"Rips diagram: 100\" # Run the scale importance analysis data1.scale <- scale_importance(pd.list = pd.list,   y = y,   cens = cens,   omega.list = c(0, 0.5, 1),   threshold = 100,   PIDs = 1:100,   outcome.type = \"survival\")  # Plot the results plot(data1.scale$threshold.seq, data1.scale$pvals); abline(v = data1.scale$min.thresh)"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/similarity_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct a pairwise similarity matrix — similarity_matrix","title":"Construct a pairwise similarity matrix — similarity_matrix","text":"similarity_matrix helper function used within rips_similarity_matrix function construct pairwise similarity matrix comparing pairs persistence diagrams.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/similarity_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct a pairwise similarity matrix — similarity_matrix","text":"","code":"similarity_matrix(rips.list, n.sample, PIDs, print.progress = FALSE)"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/similarity_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct a pairwise similarity matrix — similarity_matrix","text":"rips.list list persistence diagrams sample n.sample number samples dataset (length rips.list) PIDs Unique identifiers sample. used name resulting similarity matrix. print.progress progress bar printed?","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/similarity_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct a pairwise similarity matrix — similarity_matrix","text":"Returns list kernel (similarity matrices) homology group.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/similarity_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct a pairwise similarity matrix — similarity_matrix","text":"","code":"require(magrittr) require(TDAstats) #> Loading required package: TDAstats  # Save the PIDs PIDs <- unique(data1.df$PID)  # Save the number of samples n.sample <- length(PIDs)  # Initialize a list to store the Rips filtrations rips.list <- lapply(1:n.sample, function(i) list()); names(rips.list) <- PIDs  # Iterate through the samples to construct Rips filtration for (i in PIDs) {    # Subset the data to just this PID  data.i <- data1.df %>%    dplyr::filter(PID == i) %>%    dplyr::select(x,y)   # Construct a Rips filtration using TDAstats  rips.i <- TDAstats::calculate_homology(data.i, dim = 1, threshold = 10)   # Save  rips.list[[i]] <- rips.i }  K.list <- similarity_matrix(rips.list, n.sample, PIDs)"},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/y.html","id":null,"dir":"Reference","previous_headings":"","what":"Outcome vector y — y","title":"Outcome vector y — y","text":"vector contains outcomes simulated data. simulated survival outcomes exponential distribution. 100 samples, simulated event times two different exponential distributions.","code":""},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/y.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Outcome vector y — y","text":"","code":"y"},{"path":[]},{"path":"https://sarahsamorodnitsky.github.io/TopKAT/reference/y.html","id":"y","dir":"Reference","previous_headings":"","what":"y","title":"Outcome vector y — y","text":"vector length 100 event times.","code":""}]
